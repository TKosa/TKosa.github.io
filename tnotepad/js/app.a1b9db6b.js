(function(t){function e(e){for(var s,o,c=e[0],a=e[1],l=e[2],h=0,u=[];h<c.length;h++)o=c[h],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&u.push(i[o][0]),i[o]=0;for(s in a)Object.prototype.hasOwnProperty.call(a,s)&&(t[s]=a[s]);d&&d(e);while(u.length)u.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],s=!0,c=1;c<n.length;c++){var a=n[c];0!==i[a]&&(s=!1)}s&&(r.splice(e--,1),t=o(o.s=n[0]))}return t}var s={},i={app:0},r=[];function o(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=s,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(n,s,function(e){return t[e]}.bind(null,s));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/tnotepad/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],a=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var d=a;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"1dc6":function(t,e,n){"use strict";var s=n("2563"),i=n.n(s);i.a},2563:function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);var s=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"root"}},[n("ActionsBar",{attrs:{id:"ActionsBar"}}),n("NoteContainer")],1)},r=[],o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{attrs:{id:"actionsBar"}},[n("div",{staticClass:"button cell",attrs:{id:"download_button"},on:{click:t.download}},[t._v(" Download ")]),n("div",{staticClass:"button cell",attrs:{id:"upload_button"},on:{click:t.clickInput}},[t._v(" Upload ")]),n("input",{staticClass:"cell",staticStyle:{display:"none"},attrs:{id:"in",type:"file"}})])])},c=[],a={name:"ActionsBar",components:{},data(){return{inputElement:null}},methods:{download(){var t=this.$store.getters.getNotes,e=JSON.stringify(t),n=new Blob([e],{type:"application/octet-binary"}),s=document.createElement("a");s.setAttribute("href",URL.createObjectURL(n)),s.setAttribute("download","notes.json"),s.click()},upload(){var t=this.$store,e=this.inputElement.files[0];e.text().then(e=>t.commit("loadNotes",JSON.parse(e)))},clickInput(){this.inputElement.click()}},created(){document.addEventListener("keydown",t=>{switch(t.key){case"s":t.ctrlKey&&(t.preventDefault(),this.download());break;case"o":t.ctrlKey&&(t.preventDefault(),document.getElementById("in").click());break}})},mounted(){this.inputElement=document.getElementById("in"),this.inputElement.addEventListener("input",t=>{this.upload()})}},l=a,d=(n("a1a4"),n("2877")),h=Object(d["a"])(l,o,c,!1,null,"475d0159",null),u=h.exports,p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{NoteContainer:!0,selected:t.isSelected},staticStyle:{padding:"2px"},on:{click:function(e){return e.stopPropagation(),t.onClick(e)}}},t._l(t.children,(function(t){return n("NoteInstance",{staticClass:"instance",attrs:{note_id:t}})})),1)},f=[],b=n("2f62"),g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"base"},[n("div",{class:{elements:!0,selected:t.isSelected,focused:t.isFocused},style:{height:t.height+"px"},on:{click:function(e){return e.stopPropagation(),t.onClick(e)},dblclick:function(e){return e.stopPropagation(),t.onDblclick(e)}}},[n("button",{class:{boldButton:t.children.length>0},on:{click:t.toggleChildren}},[t._v(" "+t._s(t.button_text)+" ")]),n("textarea",{directives:[{name:"model",rawName:"v-model:value",value:t.text,expression:"text",arg:"value"}],attrs:{type:"text",spellcheck:t.SPELLCHECK,readonly:!t.isFocused},domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value)}}})]),t.children_instantiated?n("div",{class:{hidden:">"==t.button_text}},t._l(t.children,(function(t){return n("NoteInstance",{attrs:{note_id:t}})})),1):t._e()])},v=[];n("c437");var m={name:"NoteInstance",components:{},props:{note_id:String},data(){return{button_text:">",children_instantiated:!1,is_root:!1,height:10}},methods:{onClick(t){this.$emit("click",{instance:this,event:t})},onDblclick(t){this.$emit("dblclick",{instance:this,event:t})},toggleChildren(){this.children_instantiated=!0,this.button_text=">"==this.button_text?"v":">"},isVisible(){return 0!=this.$parent.$children.length&&(this.$parent==this.root||this.$parent.isVisible()&&"v"==this.$parent.button_text)},previousSibling(){return 0==this.index?this.siblings[this.siblings.length-1]:this.siblings[this.index-1]},nextSibling(){return this.siblings[(this.index+1)%this.siblings.length]},expand(){this.isFolded&&this.toggleChildren()},isLastSibling(){return this.index==this.siblings.length-1},path(){return this.$parent.path().concat([this])},indexAsSibling(){return this.$parent.$children.indexOf(this)},wasDeleted(){return-1==this.indexAsSibling()},resize(){this.height<this.textArea.scrollHeight&&(this.height=this.textArea.scrollHeight),this.height>this.textArea.scrollHeight&&(this.height=0,this.$nextTick(function(){this.height=this.textArea.scrollHeight}.bind(this)))},scrollIntoView(){var t=this.textArea.getBoundingClientRect();(t.top<0||t.bottom>window.innerHeight)&&this.textArea.scrollIntoView()}},computed:{...Object(b["b"])({children(t){return t.notes[this.note_id].children},parents(t){return t.notes[this.note_id].parents},parentNote(t){return this.$parent.note},note(t){return t.notes[this.note_id]}}),show_children(){return this.children_instantiated&&"v"==this.button_text},primaryDiv(){return this.$el.children[0]},textArea(){return this.$el.children[0].children[1]},siblings(){return this.$parent.$children},index(){return this.indexAsSibling()},isFolded(){return">"==this.button_text},focusedElement:{set(t){this.root.focusedElement=t},get(){return this.root.focusedElement}},text:{set(t){this.$store.commit("setText",{id:this.note_id,text:t}),this.height!=this.textArea.scrollHeight&&this.resize()},get(){return this.$nextTick(this.resize.bind(this)),this.$store.getters.getText(this.note_id)}},root(){return this.is_root?this:this.$parent.root},isSelected(){var t=this.root,e=t.instanceIsSelected(this);return e},isFocused(){return this.root.focusedInstance==this},isExpanded(){return"v"==this.button_text},SPELLCHECK(){return this.$store.state.CONSTANTS.SPELLCHECK}},mounted(){this.$on("click",(function({instance:t,event:e}){this.$parent.$emit("click",{instance:t,event:e})})),this.$on("dblclick",(function({instance:t,event:e}){this.$parent.$emit("dblclick",{instance:t,event:e})}))}},I=m,x=(n("72ec"),Object(d["a"])(I,g,v,!1,null,"0012fdb7",null)),$=x.exports;const _=n("c437");var w={name:"NoteContainer",components:{NoteInstance:$},data(){return{id:"root",note_id:"root",_focusedInstance:null,_selectedInstances:[this],root:this,is_root:!0,clipboard:{notes:[]}}},methods:{callFn(t,e=!0,n=!1){t=t.bind(this);var s=e?this.selectedInstances.filter(()=>!0):[this.selectedInstances[0]],i=0,r=function(){if(!(i>=s.length)){var e=s[i];!n&&e.is_root||t(e),i+=1,this.$nextTick(r)}}.bind(this);r()},registerNewChild(){var t=_();this.$store.commit("registerNewNote",t),this.$store.commit("addChildToParent",[t,this.note_id])},removeNoteFromParent(){var t=this.note,e=this.parentNote;this.$store.commit("removeChildFromParent",{child:t,parent:e})},selectThis(){this.selectInstance(this)},selectInstance(t){this.selectedInstances.includes(t)||(this.selectedInstances=[...this.selectedInstances,t])},deselectInstance(t){this.selectedInstances=this.selectedInstances.filter(e=>e!=t)},instanceIsSelected(t){return this.selectedInstances.includes(t)},onClick(t){this.$emit("click",{instance:this,event:t})},getNewNote(){var t=_();this.$store.commit("registerNewNote",t);var e=this.$store.getters.getNoteById(t);return e},nextVisibleInstance(t){return t.is_root?this.$children.length>0?this.$children[0]:this:t.isVisible()?t.isExpanded&&t.$children.length>0?t.$children[0]:this.nextSiblingDown(t):this.nextVisibleInstance(t.$parent)},nextSiblingDown(t){return t.is_root?t.$children.length>0?t.$children[0]:t:t.isLastSibling()?t.$parent.is_root?t.root:this.nextSiblingDown(t.$parent):t.nextSibling()},previousVisibleInstance(t){if(t.is_root)return this.$children.length>0?this.$children[this.$children.length-1]:this;if(!t.isVisible())return t.$parent.isVisible()?t.$parent:this.previousVisibleInstance(t.$parent);var e=t.previousSibling(),n=this.nextVisibleInstance(e);while(n!=t)e=n,n=this.nextVisibleInstance(n);return e},deleteInstance(t){t.wasDeleted()||this.selectInstance(this.previousVisibleInstance(t),!0),this.deselectInstance(t),this.$store.commit("removeChildFromParent",{child:t.note,parent:t.$parent.note})},addToClipboard(t){this.clipboard.notes.push(t.note)},attachAllNotesOnClipboard(t){this.clipboard.notes.forEach(function(e){this.$store.commit("addChildToParent",{child:e,parent:t.note}),t.expand()}.bind(this))},path(){return[this]},expand(){},isVisible(){return!0},wasDeleted(){return!1},toggleChildren(){},scrollIntoView(){}},computed:{...Object(b["b"])({children(t){var e=t.notes[this.note_id].children;return e},note(t){return t.notes[this.note_id]}}),isSelected(){return this.instanceIsSelected(this)},firstSelectedInstance(){return this.selectedInstances[0]},selectedInstances:{set(t){this.focusedInstance=null,t.length>0&&t[0].scrollIntoView(),this.$data._selectedInstances=t},get(){return this.$data._selectedInstances}},focusedInstance:{set(t){this.$data._focusedInstance&&this.$data._focusedInstance.textArea.blur(),this.$data._focusedInstance=t,this.$data._focusedInstance&&(this.selectInstance(t),this.$nextTick(function(){var t=this.$data._focusedInstance.textArea;t.focus(),t.selectionEnd=t.selectionStart}.bind(this)))},get(){return this.$data._focusedInstance}}},created(){document.addEventListener("keydown",t=>{if(0!=this.selectedInstances.length&&(null==this.focusedInstance||"Alt"==t.key||"Tab"==t.key||"Insert"==t.key))switch(t.key){case"Alt":t.preventDefault(),this.focusedInstance=null;break;case"Insert":var e=this.getNewNote(),n=[];this.callFn((function(t){this.$store.commit("addChildToParent",{child:e,parent:t.note}),t.expand(),this.$nextTick((function(){n.push(t.$children[t.$children.length-1])}))}),!0,!0),t.altKey||(this.selectedInstances=n),setTimeout(function(){this.selectedInstances[0]!=this&&this.selectedInstances[0].scrollIntoView()}.bind(this),50);break;case"Delete":this.callFn(this.deleteInstance);break;case"c":t.ctrlKey&&(this.clipboard.notes=[],this.callFn(this.addToClipboard)),navigator.permissions.query({name:"clipboard-write"}).then(t=>{"granted"!=t.state&&"prompt"!=t.state||navigator.clipboard.writeText("")});break;case"v":t.ctrlKey&&navigator.clipboard.readText().then(t=>{""==t&&this.callFn(this.attachAllNotesOnClipboard,!0,!0)});break;case"Enter":if(1==this.selectedInstances.length){var s=this.selectedInstances[0];s!=this&&(t.preventDefault(),this.focusedInstance=s)}break;case"ArrowUp":if(t.preventDefault(),!t.shiftKey){var i=this.selectedInstances[0],r=this.previousVisibleInstance(i);this.selectedInstances=[r]}if(t.shiftKey){i=this.selectedInstances[0];var o=i.previousSibling();i!=o&&this.$store.commit("swapPosition",{parent:i.parentNote,note1:i.note,note2:o.note}),i.$parent.$forceUpdate(),this.selectedInstances=[o]}break;case"ArrowDown":if(t.preventDefault(),!t.shiftKey){i=this.selectedInstances[0];var c=this.nextVisibleInstance(i);this.selectedInstances=[c]}if(t.shiftKey){i=this.selectedInstances[0];var a=i.nextSibling();i!=a&&this.$store.commit("swapPosition",{parent:i.parentNote,note1:i.note,note2:a.note}),i.$parent.$forceUpdate(),this.selectedInstances=[a]}break;case"Tab":if(t.preventDefault(),this.focusedInstance){var l=this.focusedInstance.textArea,d=l.value,h=l.selectionStart,u=this.$store.state.CONSTANTS.TAB_WIDTH,p=u-h%u;l.value=d.substring(0,h)+" ".repeat(p)+d.substring(h),l.selectionStart=l.selectionEnd=h+p}else this.selectedInstances.forEach((function(t){t.toggleChildren()}));break}})},mounted(){this.$on("click",(function({instance:t,event:e}){e.ctrlKey?this.selectInstance(t):t!=this.focusedInstance&&(this.selectedInstances=[t])})),this.$on("dblclick",(function({instance:t,event:e}){this.focusedInstance=t}))}},k=w,y=(n("7a4d"),Object(d["a"])(k,p,f,!1,null,"51dd89bd",null)),C=y.exports,S={name:"App",components:{ActionsBar:u,NoteContainer:C}},E=S,N=(n("1dc6"),Object(d["a"])(E,i,r,!1,null,"773831b4",null)),T=N.exports,A=n("11c1"),O=n.n(A);s["a"].use(b["a"]);var P=new b["a"].Store({state:{notes:{root:{id:"root",children:[],parents:[]}},focusedElement:null,clipboard:{note:null,instance:null,event:null},CONSTANTS:{SPELLCHECK:"false",TAB_WIDTH:4}},getters:{getText:t=>e=>{return t.notes[e].text},getNotes(t){return t.notes},getFocusedElement(t){return t.focusedElement},getFocusedInstance(t){return t.focusedElement.instance},getFocusedNote(t){var e=t.focusedElement.focusedInstance.note_id,n=t.notes[e];return n},getNoteById:t=>e=>t.notes[e],getNewNote(t){var e=O()(),n={id:e,text:"",children:[]};return t.notes={...t.notes,[n.id]:n},n},noteHasChild:t=>(t,e)=>{return-1!=t.children.indexOf(e.id)}},mutations:{registerNewNote(t,e){var n={id:e,text:"",children:[],parents:[]};t.notes={...t.notes,[e]:n}},addChildToParent(t,{child:e,parent:n}){n.children.push(e.id),e.parents.push(n.id)},removeChildFromParent(t,{child:e,parent:n}){n.children=n.children.filter(t=>t!=e.id),e.parents=e.parents.filter(t=>t!=n.id)},setFocusedElement(t,e){t.focusedElement!=e&&(t.focusedElement=e)},setText(t,{id:e,text:n}){t.notes[e].text=n},loadNotes(t,e){t.notes=e},focusElement(t,e){t.focusedElement=e},focusInstance(t,e){var n=t.focusedElement.tagName.toLowerCase();t.focusedElement=e.elements[n]},copyToClipboard(t,{instance:e,event:n}){"root"!=e.note.id&&(t.clipboard.note=e.note,t.clipboard.instance=e,t.clipboard.event=n)},clearClipboard(t){t.clipboard.instance=null,t.clipboard.event=null},swapPosition(t,{parent:e,note1:n,note2:s}){var i=e.children.indexOf(n.id),r=e.children.indexOf(s.id);-1!=i&&-1!=r&&(e.children[i]=s.id,e.children[r]=n.id)}},actions:{}});s["a"].config.productionTip=!1,window.vue=new s["a"]({store:P,render:t=>t(T)}).$mount("#app")},"65a2":function(t,e,n){},"72ec":function(t,e,n){"use strict";var s=n("65a2"),i=n.n(s);i.a},"77ad":function(t,e,n){},"7a4d":function(t,e,n){"use strict";var s=n("7a8c"),i=n.n(s);i.a},"7a8c":function(t,e,n){},a1a4:function(t,e,n){"use strict";var s=n("77ad"),i=n.n(s);i.a}});
//# sourceMappingURL=app.a1b9db6b.js.map