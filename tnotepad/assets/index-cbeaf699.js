(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function U(){}function rt(t){return t()}function Ge(){return Object.create(null)}function $(t){t.forEach(rt)}function ce(t){return typeof t=="function"}function x(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Ht(t){return Object.keys(t).length===0}function ct(t,...e){if(t==null)return U;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function J(t){let e;return ct(t,n=>e=n)(),e}function ue(t,e,n){t.$$.on_destroy.push(ct(e,n))}function v(t,e){t.appendChild(e)}function D(t,e,n){t.insertBefore(e,n||null)}function S(t){t.parentNode&&t.parentNode.removeChild(t)}function at(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function w(t){return document.createElement(t)}function Z(t){return document.createTextNode(t)}function E(){return Z(" ")}function ye(){return Z("")}function L(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function ft(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function b(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Rt(t){return Array.from(t.childNodes)}function Ne(t,e){e=""+e,t.data!==e&&(t.data=e)}function qe(t,e){t.value=e??""}function Kt(t,e,n,l){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,l?"important":"")}function T(t,e,n){t.classList[n?"add":"remove"](e)}function Ut(t,e,{bubbles:n=!1,cancelable:l=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,l,e),i}let ge;function _e(t){ge=t}function Ke(){if(!ge)throw new Error("Function called outside component initialization");return ge}function Ae(t){Ke().$$.on_mount.push(t)}function Pt(t){Ke().$$.on_destroy.push(t)}function ut(){const t=Ke();return(e,n,{cancelable:l=!1}={})=>{const i=t.$$.callbacks[e];if(i){const s=Ut(e,n,{cancelable:l});return i.slice().forEach(r=>{r.call(t,s)}),!s.defaultPrevented}return!0}}const oe=[],ee=[];let re=[];const Xe=[],dt=Promise.resolve();let Te=!1;function ht(){Te||(Te=!0,dt.then(_t))}function Ie(){return ht(),dt}function Le(t){re.push(t)}const Fe=new Set;let ie=0;function _t(){if(ie!==0)return;const t=ge;do{try{for(;ie<oe.length;){const e=oe[ie];ie++,_e(e),zt(e.$$)}}catch(e){throw oe.length=0,ie=0,e}for(_e(null),oe.length=0,ie=0;ee.length;)ee.pop()();for(let e=0;e<re.length;e+=1){const n=re[e];Fe.has(n)||(Fe.add(n),n())}re.length=0}while(oe.length);for(;Xe.length;)Xe.pop()();Te=!1,Fe.clear(),_e(t)}function zt(t){if(t.fragment!==null){t.update(),$(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Le)}}function Bt(t){const e=[],n=[];re.forEach(l=>t.indexOf(l)===-1?e.push(l):n.push(l)),n.forEach(l=>l()),re=e}const Se=new Set;let te;function me(){te={r:0,c:[],p:te}}function be(){te.r||$(te.c),te=te.p}function I(t,e){t&&t.i&&(Se.delete(t),t.i(e))}function A(t,e,n,l){if(t&&t.o){if(Se.has(t))return;Se.add(t),te.c.push(()=>{Se.delete(t),l&&(n&&t.d(1),l())}),t.o(e)}else l&&l()}function He(t,e){A(t,1,1,()=>{e.delete(t.key)})}function Re(t,e,n,l,i,s,r,f,_,o,c,h){let a=t.length,u=s.length,g=a;const m={};for(;g--;)m[t[g].key]=g;const p=[],y=new Map,O=new Map,P=[];for(g=u;g--;){const C=h(i,s,g),H=n(C);let R=r.get(H);R?l&&P.push(()=>R.p(C,e)):(R=o(H,C),R.c()),y.set(H,p[g]=R),H in m&&O.set(H,Math.abs(g-m[H]))}const G=new Set,Q=new Set;function q(C){I(C,1),C.m(f,c),r.set(C.key,C),c=C.first,u--}for(;a&&u;){const C=p[u-1],H=t[a-1],R=C.key,K=H.key;C===H?(c=C.first,a--,u--):y.has(K)?!r.has(R)||G.has(R)?q(C):Q.has(K)?a--:O.get(R)>O.get(K)?(Q.add(R),q(C)):(G.add(K),a--):(_(H,r),a--)}for(;a--;){const C=t[a];y.has(C.key)||_(C,r)}for(;u;)q(p[u-1]);return $(P),p}function V(t){t&&t.c()}function j(t,e,n,l){const{fragment:i,after_update:s}=t.$$;i&&i.m(e,n),l||Le(()=>{const r=t.$$.on_mount.map(rt).filter(ce);t.$$.on_destroy?t.$$.on_destroy.push(...r):$(r),t.$$.on_mount=[]}),s.forEach(Le)}function W(t,e){const n=t.$$;n.fragment!==null&&(Bt(n.after_update),$(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Jt(t,e){t.$$.dirty[0]===-1&&(oe.push(t),ht(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ne(t,e,n,l,i,s,r,f=[-1]){const _=ge;_e(t);const o=t.$$={fragment:null,ctx:[],props:s,update:U,not_equal:i,bound:Ge(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(_?_.$$.context:[])),callbacks:Ge(),dirty:f,skip_bound:!1,root:e.target||_.$$.root};r&&r(o.root);let c=!1;if(o.ctx=n?n(t,e.props||{},(h,a,...u)=>{const g=u.length?u[0]:a;return o.ctx&&i(o.ctx[h],o.ctx[h]=g)&&(!o.skip_bound&&o.bound[h]&&o.bound[h](g),c&&Jt(t,h)),a}):[],o.update(),c=!0,$(o.before_update),o.fragment=l?l(o.ctx):!1,e.target){if(e.hydrate){const h=Rt(e.target);o.fragment&&o.fragment.l(h),h.forEach(S)}else o.fragment&&o.fragment.c();e.intro&&I(t.$$.fragment),j(t,e.target,e.anchor,e.customElement),_t()}_e(_)}class le{$destroy(){W(this,1),this.$destroy=U}$on(e,n){if(!ce(n))return U;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const i=l.indexOf(n);i!==-1&&l.splice(i,1)}}$set(e){this.$$set&&!Ht(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const se=[];function ve(t,e=U){let n;const l=new Set;function i(f){if(x(t,f)&&(t=f,n)){const _=!se.length;for(const o of l)o[1](),se.push(o,t);if(_){for(let o=0;o<se.length;o+=2)se[o][0](se[o+1]);se.length=0}}}function s(f){i(f(t))}function r(f,_=U){const o=[f,_];return l.add(o),l.size===1&&(n=e(i)||U),f(t),()=>{l.delete(o),l.size===0&&n&&(n(),n=null)}}return{set:i,update:s,subscribe:r}}class Ce{constructor(e,n="",l=[]){this.id=e,this.markup=ve(n),this.children=ve(l)}add(e){J(this.children).includes(e.id)||this.children.set([...J(this.children),e.id])}}const je=2;class ae{constructor(){var e=new Ce(0);this.notes={0:e},this.uID=1,this.version=je}reset(){var e=new Ce(0);this.notes={0:e},this.uID=1}loadFromJSON(e){var n;for(n in e.notes){var l=e.notes[n],i=new Ce(n);i.children.set(l.children),i.markup.set(l.markup),this.notes[n]=i}this.Update()}getCopyForDownload(){let e=(function(l){let i=(function(s,r){r[s.id]||(r[s.id]={id:s.id,markup:J(s.markup),children:J(s.children)},J(s.children).forEach((function(f){i(this.notes[f],r)}).bind(this)))}).bind(this);return i(this.notes[0],l),l}).bind(this),n={version:this.version,notes:{}};return e(n.notes),n}addNewChild({parent:e}){var n=this.getNewNote();return e.add(n),n}getNoteByID(e){return this.notes[e]}getNextUID(){for(;this.uID in this.notes;)this.uID++;return this.uID}swapPlaces(e,n,l){for(var i=J(e.children),s=0;s<i.length;s++)if([n.id,l.id].includes(i[s])){[i[s],i[s+1]]=[i[s+1],i[s]];return}}getNewNote(){var e=this.getNextUID(),n=new Ce(e);return this.notes[e]=n,n}getRoot(){var e=this.notes[0];if(!e)throw new Error("no root found");return e}Merge(e,n){var l=e.notes[0],i=0,s=(function(){return i+=1,!(i in this.notes)&&!(i in e.notes)?i:s()}).bind(this),r;for(var r in e.notes){var f=s();e.editNoteId(+r,f)}this.notes={...this.notes,...e.notes};var _=J(this.getRoot().children).length==0;return _?(J(l.children).forEach(o=>{this.getRoot().add(this.notes[o])}),Ie().then(()=>{document.title=n})):(this.getRoot().add(l),l.markup.set(n)),l}editNoteId(e,n){var l=this.notes[e];l.id=n,delete this.notes[e],this.notes[n]=l;var i;for(i in this.notes){var l=this.notes[i];l.children.set(J(l.children).map(r=>r==e?n:r)),l.markup.set(String(J(l.markup)).replace(ae.GetNoteLinkOpeningTag(e),ae.GetNoteLinkOpeningTag(n)))}}Update(){for(this.version||(this.version=1);this.version<je;)this.UpgradeByOneVersion()}UpgradeByOneVersion(){switch(this.version){}this.version++}static GetNoteLinkOpeningTag(e){return`<a id="${e}" href="#0">`}swapNotes(e,n,l){var i=J(e.children).map(function(s){return s==n.id?l.id:s==l.id?n.id:s});e.children.set(i)}}let pe=new ae,$t=0;const Gt=function(){return $t++},de=ve(null),Ee=ve(null),he=ve([]),Y={copiedInstances:[],copyMode:"copy"},qt={MIN_TEXTBOX_HEIGHT:50};function We(t,e,n){const l=t.slice();return l[2]=e[n],l[51]=e,l[52]=n,l}function Ve(t,e,n){const l=t.slice();return l[2]=e[n],l[53]=e,l[52]=n,l}function Qe(t,e,n){const l=t.slice();return l[2]=e[n],l[54]=e,l[52]=n,l}function Xt(t){let e,n=[],l=new Map,i,s,r,f=t[5];const _=o=>o[2];for(let o=0;o<f.length;o+=1){let c=Qe(t,f,o),h=_(c);l.set(h,n[o]=Ye(h,c))}return{c(){e=w("div");for(let o=0;o<n.length;o+=1)n[o].c();b(e,"id","notepad"),b(e,"class","svelte-3hyb3y"),T(e,"isFocused",t[11])},m(o,c){D(o,e,c);for(let h=0;h<n.length;h+=1)n[h]&&n[h].m(e,null);i=!0,s||(r=L(e,"click",ft(t[33])),s=!0)},p(o,c){c[0]&786722&&(f=o[5],me(),n=Re(n,c,_,1,o,f,l,e,He,Ye,null,Qe),be()),(!i||c[0]&2048)&&T(e,"isFocused",o[11])},i(o){if(!i){for(let c=0;c<f.length;c+=1)I(n[c]);i=!0}},o(o){for(let c=0;c<n.length;c+=1)A(n[c]);i=!1},d(o){o&&S(e);for(let c=0;c<n.length;c+=1)n[c].d();s=!1,r()}}}function Ye(t,e){let n,l,i=e[52],s;const r=()=>e[31](l,i),f=()=>e[31](null,i);let _={noteId:e[2]};return l=new De({props:_}),r(),l.$on("SwapChildren",e[18]),l.$on("DeleteChild",e[19]),l.$on("Focus",e[32]),{key:t,first:null,c(){n=ye(),V(l.$$.fragment),this.first=n},m(o,c){D(o,n,c),j(l,o,c),s=!0},p(o,c){e=o,i!==e[52]&&(f(),i=e[52],r());const h={};c[0]&32&&(h.noteId=e[2]),l.$set(h)},i(o){s||(I(l.$$.fragment,o),s=!0)},o(o){A(l.$$.fragment,o),s=!1},d(o){o&&S(n),f(),W(l,o)}}}function jt(t){let e,n,l=t[3]?"v":">",i,s,r,f,_,o,c,h;function a(p,y){return p[12]?Vt:Wt}let u=a(t),g=u(t),m=t[4]&&Ze(t);return{c(){e=w("div"),n=w("button"),i=Z(l),s=E(),r=w("span"),g.c(),f=E(),m&&m.c(),_=ye(),b(n,"id","toggleButton"),b(n,"class","svelte-3hyb3y"),T(n,"boldText",t[5].length>0),b(r,"id","text"),b(r,"class","svelte-3hyb3y"),b(e,"id","topRow"),b(e,"class","svelte-3hyb3y")},m(p,y){D(p,e,y),v(e,n),v(n,i),v(e,s),v(e,r),g.m(r,null),D(p,f,y),m&&m.m(p,y),D(p,_,y),o=!0,c||(h=[L(n,"click",t[34]),L(r,"click",ft(t[37]))],c=!0)},p(p,y){(!o||y[0]&8)&&l!==(l=p[3]?"v":">")&&Ne(i,l),(!o||y[0]&32)&&T(n,"boldText",p[5].length>0),u===(u=a(p))&&g?g.p(p,y):(g.d(1),g=u(p),g&&(g.c(),g.m(r,null))),p[4]?m?(m.p(p,y),y[0]&16&&I(m,1)):(m=Ze(p),m.c(),I(m,1),m.m(_.parentNode,_)):m&&(me(),A(m,1,1,()=>{m=null}),be())},i(p){o||(I(m),o=!0)},o(p){A(m),o=!1},d(p){p&&S(e),g.d(),p&&S(f),m&&m.d(p),p&&S(_),c=!1,$(h)}}}function Wt(t){let e,n,l;return{c(){e=w("span")},m(i,s){D(i,e,s),e.innerHTML=t[6],n||(l=L(e,"click",t[20]),n=!0)},p(i,s){s[0]&64&&(e.innerHTML=i[6])},d(i){i&&S(e),n=!1,l()}}}function Vt(t){let e,n,l;return{c(){e=w("textarea"),b(e,"class","svelte-3hyb3y")},m(i,s){D(i,e,s),t[35](e),qe(e,t[6]),n||(l=[L(e,"input",t[36]),L(e,"input",t[21])],n=!0)},p(i,s){s[0]&64&&qe(e,i[6])},d(i){i&&S(e),t[35](null),n=!1,$(l)}}}function Ze(t){let e,n=[],l=new Map,i,s=[],r=new Map,f,_=t[5];const o=a=>a[2];for(let a=0;a<_.length;a+=1){let u=Ve(t,_,a),g=o(u);l.set(g,n[a]=xe(g,u))}let c=t[10];const h=a=>a[2];for(let a=0;a<c.length;a+=1){let u=We(t,c,a),g=h(u);r.set(g,s[a]=et(g,u))}return{c(){e=w("div");for(let a=0;a<n.length;a+=1)n[a].c();i=E();for(let a=0;a<s.length;a+=1)s[a].c();b(e,"id","childContainer"),b(e,"class","svelte-3hyb3y"),T(e,"hidden",!t[3])},m(a,u){D(a,e,u);for(let g=0;g<n.length;g+=1)n[g]&&n[g].m(e,null);v(e,i);for(let g=0;g<s.length;g+=1)s[g]&&s[g].m(e,null);f=!0},p(a,u){u[0]&786722&&(_=a[5],me(),n=Re(n,u,o,1,a,_,l,e,He,xe,i,Ve),be()),u[0]&525826&&(c=a[10],me(),s=Re(s,u,h,1,a,c,r,e,He,et,null,We),be()),(!f||u[0]&8)&&T(e,"hidden",!a[3])},i(a){if(!f){for(let u=0;u<_.length;u+=1)I(n[u]);for(let u=0;u<c.length;u+=1)I(s[u]);f=!0}},o(a){for(let u=0;u<n.length;u+=1)A(n[u]);for(let u=0;u<s.length;u+=1)A(s[u]);f=!1},d(a){a&&S(e);for(let u=0;u<n.length;u+=1)n[u].d();for(let u=0;u<s.length;u+=1)s[u].d()}}}function xe(t,e){let n,l,i=e[52],s;const r=()=>e[38](l,i),f=()=>e[38](null,i);let _={noteId:e[2]};return l=new De({props:_}),r(),l.$on("SwapChildren",e[18]),l.$on("DeleteChild",e[19]),l.$on("Focus",e[39]),{key:t,first:null,c(){n=ye(),V(l.$$.fragment),this.first=n},m(o,c){D(o,n,c),j(l,o,c),s=!0},p(o,c){e=o,i!==e[52]&&(f(),i=e[52],r());const h={};c[0]&32&&(h.noteId=e[2]),l.$set(h)},i(o){s||(I(l.$$.fragment,o),s=!0)},o(o){A(l.$$.fragment,o),s=!1},d(o){o&&S(n),f(),W(l,o)}}}function et(t,e){let n,l,i=e[52],s;const r=()=>e[40](l,i),f=()=>e[40](null,i);let _={noteId:e[2],isReference:!0};return l=new De({props:_}),r(),l.$on("DeleteChild",e[19]),l.$on("Focus",e[41]),{key:t,first:null,c(){n=ye(),V(l.$$.fragment),this.first=n},m(o,c){D(o,n,c),j(l,o,c),s=!0},p(o,c){e=o,i!==e[52]&&(f(),i=e[52],r());const h={};c[0]&1024&&(h.noteId=e[2]),l.$set(h)},i(o){s||(I(l.$$.fragment,o),s=!0)},o(o){A(l.$$.fragment,o),s=!1},d(o){o&&S(n),f(),W(l,o)}}}function Qt(t){let e,n,l,i=t[15]&&Xt(t),s=!t[15]&&jt(t);return{c(){e=w("div"),i&&i.c(),n=E(),s&&s.c(),b(e,"id","note "+t[14].id),b(e,"class","noteWrapper svelte-3hyb3y"),b(e,"style",t[15]?"height: 100%;":""),T(e,"isSelected",t[13]),T(e,"isExpanded",t[3]),T(e,"isFocused",t[11]),T(e,"referenceContainer",t[0])},m(r,f){D(r,e,f),i&&i.m(e,null),v(e,n),s&&s.m(e,null),l=!0},p(r,f){r[15]&&i.p(r,f),r[15]||s.p(r,f),(!l||f[0]&8192)&&T(e,"isSelected",r[13]),(!l||f[0]&8)&&T(e,"isExpanded",r[3]),(!l||f[0]&2048)&&T(e,"isFocused",r[11]),(!l||f[0]&1)&&T(e,"referenceContainer",r[0])},i(r){l||(I(i),I(s),l=!0)},o(r){A(i),A(s),l=!1},d(r){r&&S(e),i&&i.d(),s&&s.d()}}}function tt(t,e){var n=t.selectionStart,l=t.selectionEnd;t.value=t.value.substring(0,n)+e+t.value.substring(l),t.selectionStart=t.selectionEnd=n+e.length}function Yt(t){return t.endsWith("*")?t.slice(0,-1):t}function Zt(t,e,n){let l,i,s,r,f,_,o,c;ue(t,he,d=>n(28,_=d)),ue(t,Ee,d=>n(29,o=d)),ue(t,de,d=>n(30,c=d));const h=ut(),a=function(){h("DeleteChild",{target:O,isFocused:we})},u=Gt();let{noteId:g}=e,{isReference:m=!1}=e,y=pe.notes[g];const O={note:y,noteId:g,instanceId:u,Delete:a};let P,G=[],Q=[],q=[];const C=g==0;let H=y.markup;ue(t,H,d=>n(6,f=d));let R=y.children;ue(t,R,d=>n(5,r=d));let K=!1;const Ue=function(){n(3,K=!0)},Pe=async function(d){if(!(d<=0)){await Ie();var k=[...G,...Q];k.forEach(M=>{M.Expand(),M.ExpandAll(d-1)})}};let we=!1,{Focus:X=function(d=!1){if(c!=O&&Ee.set(null),de.set(O),C){d||he.set([]);return}else Me(O,d)}}=e;O.Focus=X;let Me=function(d,k){let M=k?[..._,d]:[d];he.set(M)},mt=function(d){let{child_to_swap:k,moveUp:M}=d.detail;var N=r.indexOf(k),F=N+(M?-1:1),z=F>=0&&F<r.length;if(z){let B=[...r];[B[N],B[F]]=[B[F],B[N]],R.set(B)}},bt=function(d){let{target:k,isFocused:M}=d.detail;if(M){var N=ke();let z=N.indexOf(k);if(z==1)X();else{var F=N[z-1];de.set(F),he.set([F])}}n(10,q=q.filter(z=>z!=k.instanceId)),R.set([...r.filter(z=>z!=k.note.id)])};const ke=function(){var d=[O];if(K||C){var k=[...G,...Q];k.forEach(M=>{if(M!=null){var N=[];N=M.getSortedGenespan(),d=d.concat(N)}})}return d};let ze=function(d){if(we){if(d.stopImmediatePropagation(),!l)switch(d.key){case"ArrowUp":d.shiftKey&&h("SwapChildren",{child_to_swap:y.id,moveUp:!0});break;case"ArrowDown":d.shiftKey&&h("SwapChildren",{child_to_swap:y.id,moveUp:!1});break;case"ArrowLeft":h("Focus",{keepSelection:d.ctrlKey});break;case"Insert":d.preventDefault();var k=pe.addNewChild({parent:y});n(3,K=!0),d.ctrlKey||Ie().then(()=>{ke().forEach(N=>{N.note==k&&(de.set(N),he.set([N]))})});break;case"Tab":d.preventDefault(),n(3,K=!K),d.shiftKey&&Pe(2);break;case"Enter":C||(d.preventDefault(),Ee.set(O),Ie().then(()=>{P.focus(),Me(O,!1),Be()}));break;case"i":if(d.ctrlKey)debugger;break;case"c":d.ctrlKey&&(Y.copiedInstances=[..._],Y.copyMode="copy");break;case"x":d.ctrlKey&&(Y.copiedInstances=[..._],Y.copyMode="cut");break;case"v":Y.copiedInstances.forEach(function(M){var N=r.includes(M.noteId);N||(y.add(M.note),Y.copyMode=="cut"&&M.Delete())}),r.length>0&&n(3,K=!0);break;case"Alt":d.preventDefault();break}if(l)switch(d.key){case"Enter":break;case"Alt":d.preventDefault(),Ee.set(null);break;case"Tab":d.preventDefault(),tt(P,"	");break;case"b":d.ctrlKey&&Y.copiedInstances.length>0&&(d.preventDefault(),vt(P))}}};function vt(d){let k=Y.copiedInstances[0].note,M=ae.GetNoteLinkOpeningTag(k.id)+"</a>";tt(d,M),H.set(d.value)}Ae(()=>{window.addEventListener("keydown",ze)}),Pt(()=>{window.removeEventListener("keydown",ze)});function yt(d){d.target.tagName==="A"&&(wt(+d.target.id),Ue())}function wt(d){q.includes(d)||r.includes(d)||n(10,q=[...q,d])}function Be(){var d=Math.max(qt.MIN_TEXTBOX_HEIGHT,P.scrollHeight)+"px";n(7,P.style.height=d,P)}C&&(Ae(X),window.addEventListener("keydown",function(k){let M=function(N){for(var F=ke(),z,B=0;B<F.length;B++){var Tt=F[B];if(Tt==c){z=B;break}}var Oe=z+(N?-1:1),Lt=Oe>=0&&Oe<F.length;return Lt?F[Oe]:null};if((k.key=="ArrowUp"||k.key=="ArrowDown")&&o==null&&(k.preventDefault(),!k.shiftKey)){let N=k.key=="ArrowUp",F=M(N);F!=null&&(de.set(F),Me(F,k.ctrlKey))}k.key=="Delete"&&_.forEach(N=>{N.Delete()})}));var Je=function(){document.title.endsWith("*")||(document.title=document.title+"*")};C&&Ae(()=>{document.title=Yt(document.title)});function $e(){h("CloseHelp")}function kt(d,k){ee[d?"unshift":"push"](()=>{G[k]=d,n(8,G)})}const Ct=d=>{X(d.detail.keepSelection)},Et=d=>{X(d.ctrlKey),$e()},It=()=>{n(3,K=!K)};function St(d){ee[d?"unshift":"push"](()=>{P=d,n(7,P)})}function Nt(){f=this.value,H.set(f)}const Dt=d=>{X(d.ctrlKey)};function Mt(d,k){ee[d?"unshift":"push"](()=>{G[k]=d,n(8,G)})}const Ot=d=>{X(d.detail.keepSelection)};function At(d,k){ee[d?"unshift":"push"](()=>{Q[k]=d,n(9,Q)})}const Ft=d=>{X(d.detail.keepSelection)};return t.$$set=d=>{"noteId"in d&&n(2,g=d.noteId),"isReference"in d&&n(0,m=d.isReference),"Focus"in d&&n(1,X=d.Focus)},t.$$.update=()=>{t.$$.dirty[0]&671088640&&n(12,l=o==O),t.$$.dirty[0]&24&&n(4,i=K||i),t.$$.dirty[0]&1207959552&&n(11,we=c===O),t.$$.dirty[0]&402653184&&n(13,s=_.includes(O)),t.$$.dirty[0]&64&&Je(),t.$$.dirty[0]&32&&Je()},[m,X,g,K,i,r,f,P,G,Q,q,we,l,s,y,C,H,R,mt,bt,yt,Be,$e,u,Ue,Pe,ke,O,_,o,c,kt,Ct,Et,It,St,Nt,Dt,Mt,Ot,At,Ft]}class De extends le{constructor(e){super(),ne(this,e,Zt,Qt,x,{instanceId:23,noteId:2,isReference:0,Expand:24,ExpandAll:25,Focus:1,getSortedGenespan:26},null,[-1,-1])}get instanceId(){return this.$$.ctx[23]}get Expand(){return this.$$.ctx[24]}get ExpandAll(){return this.$$.ctx[25]}get getSortedGenespan(){return this.$$.ctx[26]}}const fe="tnpKeys";function xt(t,e){let n=JSON.parse(localStorage.getItem(fe)??"[]");if(!n.includes(t)){let l=[t,...n];localStorage.setItem(fe,JSON.stringify(l))}localStorage.setItem(t,e)}function en(){let t=JSON.parse(localStorage.getItem(fe)??"[]");if(t.length===0)return!1;const e=t[t.length-1];return t.pop(),localStorage.removeItem(e),localStorage.setItem(fe,JSON.stringify(t)),!0}function pt(t,e){try{xt(t,e),document.title=t}catch(n){if(n instanceof DOMException&&n.name==="QuotaExceededError")en()&&pt(t,e);else throw n}}function tn(t){let e=JSON.parse(localStorage.getItem(fe)??"[]");const n=e.indexOf(t);n>-1&&(e.splice(n,1),localStorage.removeItem(t),localStorage.setItem(fe,JSON.stringify(e)))}function nt(t){let e,n,l,i,s,r,f,_,o,c;return{c(){e=w("div"),n=w("div"),l=w("p"),i=Z(t[0]),s=E(),r=w("button"),r.textContent="Yes",f=E(),_=w("button"),_.textContent="No",b(r,"class","svelte-v3dq6t"),b(_,"class","svelte-v3dq6t"),b(n,"class","modal-content svelte-v3dq6t"),b(e,"class","modal svelte-v3dq6t")},m(h,a){D(h,e,a),v(e,n),v(n,l),v(l,i),v(n,s),v(n,r),v(n,f),v(n,_),o||(c=[L(r,"click",function(){ce(t[1])&&t[1].apply(this,arguments)}),L(_,"click",function(){ce(t[2])&&t[2].apply(this,arguments)})],o=!0)},p(h,a){t=h,a&1&&Ne(i,t[0])},d(h){h&&S(e),o=!1,$(c)}}}function nn(t){let e,n=t[3]&&nt(t);return{c(){n&&n.c(),e=ye()},m(l,i){n&&n.m(l,i),D(l,e,i)},p(l,[i]){l[3]?n?n.p(l,i):(n=nt(l),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:U,o:U,d(l){n&&n.d(l),l&&S(e)}}}function ln(t,e,n){let{message:l}=e,{onConfirm:i}=e,{onCancel:s}=e,{visible:r}=e;return t.$$set=f=>{"message"in f&&n(0,l=f.message),"onConfirm"in f&&n(1,i=f.onConfirm),"onCancel"in f&&n(2,s=f.onCancel),"visible"in f&&n(3,r=f.visible)},[l,i,s,r]}class sn extends le{constructor(e){super(),ne(this,e,ln,nn,x,{message:0,onConfirm:1,onCancel:2,visible:3})}}function lt(t,e,n){const l=t.slice();return l[13]=e[n],l}function it(t){let e,n,l,i,s,r,f,_,o=t[2],c=[];for(let h=0;h<o.length;h+=1)c[h]=st(lt(t,o,h));return{c(){e=w("div"),n=w("div"),l=w("table"),i=w("tr"),s=w("td"),s.textContent="Ã—",r=E();for(let h=0;h<c.length;h+=1)c[h].c();b(s,"class","close-button svelte-1izo68e"),b(i,"class","svelte-1izo68e"),b(l,"class","svelte-1izo68e"),b(n,"class","modal-content svelte-1izo68e"),b(e,"class","modal svelte-1izo68e")},m(h,a){D(h,e,a),v(e,n),v(n,l),v(l,i),v(i,s),v(l,r);for(let u=0;u<c.length;u+=1)c[u]&&c[u].m(l,null);f||(_=L(s,"click",function(){ce(t[1])&&t[1].apply(this,arguments)}),f=!0)},p(h,a){if(t=h,a&54){o=t[2];let u;for(u=0;u<o.length;u+=1){const g=lt(t,o,u);c[u]?c[u].p(g,a):(c[u]=st(g),c[u].c(),c[u].m(l,null))}for(;u<c.length;u+=1)c[u].d(1);c.length=o.length}},d(h){h&&S(e),at(c,h),f=!1,_()}}}function st(t){let e,n,l=t[13]+"",i,s,r,f,_,o;function c(){return t[9](t[13])}function h(){return t[10](t[13])}return{c(){e=w("tr"),n=w("td"),i=Z(l),s=E(),r=w("td"),r.textContent="x",f=E(),b(n,"class","filename svelte-1izo68e"),b(r,"class","delete-button svelte-1izo68e"),b(e,"class","svelte-1izo68e")},m(a,u){D(a,e,u),v(e,n),v(n,i),v(e,s),v(e,r),v(e,f),_||(o=[L(n,"click",c),L(r,"click",h)],_=!0)},p(a,u){t=a,u&4&&l!==(l=t[13]+"")&&Ne(i,l)},d(a){a&&S(e),_=!1,$(o)}}}function on(t){let e,n,l,i=t[0]&&it(t);return n=new sn({props:{message:"Are you sure?",onConfirm:t[6],onCancel:t[7],visible:t[3]}}),{c(){i&&i.c(),e=E(),V(n.$$.fragment)},m(s,r){i&&i.m(s,r),D(s,e,r),j(n,s,r),l=!0},p(s,[r]){s[0]?i?i.p(s,r):(i=it(s),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null);const f={};r&8&&(f.visible=s[3]),n.$set(f)},i(s){l||(I(n.$$.fragment,s),l=!0)},o(s){A(n.$$.fragment,s),l=!1},d(s){i&&i.d(s),s&&S(e),W(n,s)}}}function rn(t,e,n){let{visible:l=!1}=e,{toggleModal:i}=e,{merge_tnp_file:s}=e,r=[],f=!1,_="";function o(){n(2,r=JSON.parse(localStorage.getItem("tnpKeys"))??[])}function c(p){const y=localStorage.getItem(p);s(y,p)}function h(p){_=p,n(3,f=!0)}function a(){tn(_),o(),n(3,f=!1)}function u(){n(3,f=!1)}const g=function(p){c(p),i()},m=p=>h(p);return t.$$set=p=>{"visible"in p&&n(0,l=p.visible),"toggleModal"in p&&n(1,i=p.toggleModal),"merge_tnp_file"in p&&n(8,s=p.merge_tnp_file)},t.$$.update=()=>{t.$$.dirty&1&&l&&o()},[l,i,r,f,c,h,a,u,s,g,m]}class cn extends le{constructor(e){super(),ne(this,e,rn,on,x,{visible:0,toggleModal:1,merge_tnp_file:8})}}function an(t){let e,n,l,i,s,r,f,_,o,c,h,a,u,g,m;return a=new cn({props:{visible:t[2],toggleModal:t[6],merge_tnp_file:t[3]}}),{c(){e=w("div"),n=w("button"),n.textContent="Download",l=E(),i=w("label"),i.textContent="Upload",s=E(),r=w("input"),f=E(),_=w("button"),_.textContent="Save as",o=E(),c=w("button"),c.textContent="Load",h=E(),V(a.$$.fragment),b(n,"id","download_btn"),b(n,"class","file-button svelte-e1fw06"),b(i,"id","upload_btn"),b(i,"class","file-button svelte-e1fw06"),b(i,"for","file"),b(r,"id","file"),b(r,"type","file"),b(r,"accept",".tnp"),Kt(r,"display","none"),b(_,"id","save_as_btn"),b(_,"class","file-button svelte-e1fw06"),b(c,"id","load_btn"),b(c,"class","file-button svelte-e1fw06"),b(e,"id","MenuBar"),b(e,"class","svelte-e1fw06")},m(p,y){D(p,e,y),v(e,n),v(e,l),v(e,i),v(e,s),v(e,r),t[7](r),v(e,f),v(e,_),v(e,o),v(e,c),v(e,h),j(a,e,null),u=!0,g||(m=[L(n,"click",function(){ce(t[0])&&t[0].apply(this,arguments)}),L(r,"change",t[4]),L(_,"click",t[5]),L(c,"click",t[6])],g=!0)},p(p,[y]){t=p;const O={};y&4&&(O.visible=t[2]),a.$set(O)},i(p){u||(I(a.$$.fragment,p),u=!0)},o(p){A(a.$$.fragment,p),u=!1},d(p){p&&S(e),t[7](null),W(a),g=!1,$(m)}}}function fn(t){return t.slice(0,-4)}function un(){document.title=gt(document.title)}function gt(t){return t.endsWith("*")?t.slice(0,-1):t}function dn(t,e,n){let l;function i(a,u){let g=new ae,m=JSON.parse(a);g.loadFromJSON(m),pe.Merge(g,u)}let s=async function(){let a=Array.from(l.files);r(a),n(1,l.value="",l)};async function r(a){let u=async function(p){var y=await p.text();i(y,fn(p.name))};for(var g=0;g<a.length;g++){var m=a[g];await u(m)}}let{download:f=function(){let a=function(p){var y=document.createElement("a");y.setAttribute("href",URL.createObjectURL(p)),y.setAttribute("download",document.title+".tnp"),y.click()};var u=pe.getCopyForDownload(),g=JSON.stringify(u),m=new Blob([g],{type:"application/octet-binary"});a(m),un()}}=e;function _(){let a=prompt("Enter filename:",gt(document.title));if(a!==null&&a!==""){let u=pe.getCopyForDownload();pt(a,JSON.stringify(u))}}let o=!1;function c(){n(2,o=!o)}function h(a){ee[a?"unshift":"push"](()=>{l=a,n(1,l)})}return t.$$set=a=>{"download"in a&&n(0,f=a.download)},[f,l,o,i,s,_,c,h]}class hn extends le{constructor(e){super(),ne(this,e,dn,an,x,{download:0})}}function _n(t,e,n){const l=t.slice();return l[0]=e[n][0],l[1]=e[n][1],l}function pn(t){let e,n,l,i,s,r,f;return{c(){e=w("tr"),n=w("td"),l=Z(t[0]),i=E(),s=w("td"),r=Z(t[1]),f=E(),b(n,"class","svelte-ci6f7i"),b(s,"class","svelte-ci6f7i")},m(_,o){D(_,e,o),v(e,n),v(n,l),v(e,i),v(e,s),v(s,r),v(e,f)},p:U,d(_){_&&S(e)}}}function gn(t){let e,n,l,i,s,r,f,_=[["Insert","Add a new note under the focused one"],["Delete","Delete selected notes"],["Up/Down Arrow","Move focus up/down"],["Enter","Make a note editable"],["Alt","Return an editable note to being uneditable"],["Shift+Up/Down","Swap Adjacent Siblings"],["Click on note","Focuses note"],["Ctrl+Focus Note","Keeps notes selected while focusing new one"],["Ctrl+C/X/V","Copy/Cut/Paste selected notes"],["Ctrl+B","Paste a reference of the copied note into the text box"],["Tab","Toggles whether focused note is expanded"],["Tab+Shift","Also expands children and grandchildren"]],o=[];for(let c=0;c<12;c+=1)o[c]=pn(_n(t,_,c));return{c(){e=w("div"),n=w("div"),n.innerHTML="<h2>Controls</h2>",l=E(),i=w("table"),s=w("thead"),s.innerHTML=`<tr><th class="svelte-ci6f7i">Command</th> 
            <th class="svelte-ci6f7i">Description</th></tr>`,r=E(),f=w("tbody");for(let c=0;c<12;c+=1)o[c].c();b(n,"class","title svelte-ci6f7i"),b(i,"class","svelte-ci6f7i"),b(e,"class","menu svelte-ci6f7i")},m(c,h){D(c,e,h),v(e,n),v(e,l),v(e,i),v(i,s),v(i,r),v(i,f);for(let a=0;a<12;a+=1)o[a]&&o[a].m(f,null)},p:U,i:U,o:U,d(c){c&&S(e),at(o,c)}}}class mn extends le{constructor(e){super(),ne(this,e,null,gn,x,{})}}function bn(t){let e,n;return e=new De({props:{noteId:0}}),e.$on("CloseHelp",t[0]),{c(){V(e.$$.fragment)},m(l,i){j(e,l,i),n=!0},p:U,i(l){n||(I(e.$$.fragment,l),n=!0)},o(l){A(e.$$.fragment,l),n=!1},d(l){W(e,l)}}}function vn(t){let e=ut();function n(){e("CloseHelp")}return[n]}class yn extends le{constructor(e){super(),ne(this,e,vn,bn,x,{})}}function ot(t){let e,n,l;return n=new mn({}),{c(){e=w("div"),V(n.$$.fragment),b(e,"id","helpWrapper"),b(e,"class","svelte-wm15kg")},m(i,s){D(i,e,s),j(n,e,null),l=!0},i(i){l||(I(n.$$.fragment,i),l=!0)},o(i){A(n.$$.fragment,i),l=!1},d(i){i&&S(e),W(n)}}}function wn(t){let e,n,l,i,s,r,f=t[0]?"X":"?",_,o,c,h,a,u,g;i=new hn({});let m=t[0]&&ot();return h=new yn({}),h.$on("CloseHelp",t[1]),{c(){e=w("main"),n=w("div"),l=w("span"),V(i.$$.fragment),s=E(),r=w("button"),_=Z(f),o=E(),m&&m.c(),c=E(),V(h.$$.fragment),b(l,"id","Menubar"),b(l,"class","svelte-wm15kg"),b(r,"class","svelte-wm15kg"),T(r,"close-btn",t[0]),b(n,"id","Topbar"),b(n,"class","svelte-wm15kg"),b(e,"data-testid","my-element"),b(e,"class","svelte-wm15kg")},m(p,y){D(p,e,y),v(e,n),v(n,l),j(i,l,null),v(n,s),v(n,r),v(r,_),v(e,o),m&&m.m(e,null),v(e,c),j(h,e,null),a=!0,u||(g=L(r,"click",t[2]),u=!0)},p(p,[y]){(!a||y&1)&&f!==(f=p[0]?"X":"?")&&Ne(_,f),(!a||y&1)&&T(r,"close-btn",p[0]),p[0]?m?y&1&&I(m,1):(m=ot(),m.c(),I(m,1),m.m(e,c)):m&&(me(),A(m,1,1,()=>{m=null}),be())},i(p){a||(I(i.$$.fragment,p),I(m),I(h.$$.fragment,p),a=!0)},o(p){A(i.$$.fragment,p),A(m),A(h.$$.fragment,p),a=!1},d(p){p&&S(e),W(i),m&&m.d(),W(h),u=!1,g()}}}function kn(t,e,n){let l=!1;return[l,function(){n(0,l=!1)},()=>n(0,l=!l)]}class Cn extends le{constructor(e){super(),ne(this,e,kn,wn,x,{})}}new Cn({target:document.getElementById("app")});
