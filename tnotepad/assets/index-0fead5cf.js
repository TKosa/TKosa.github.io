(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function q(){}function Qe(t){return t()}function Ue(){return Object.create(null)}function H(t){t.forEach(Qe)}function Ce(t){return typeof t=="function"}function be(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function mt(t){return Object.keys(t).length===0}function Ye(t,...e){if(t==null)return q;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function K(t){let e;return Ye(t,n=>e=n)(),e}function ne(t,e,n){t.$$.on_destroy.push(Ye(e,n))}function M(t,e){t.appendChild(e)}function A(t,e,n){t.insertBefore(e,n||null)}function L(t){t.parentNode&&t.parentNode.removeChild(t)}function z(t){return document.createElement(t)}function Oe(t){return document.createTextNode(t)}function X(){return Oe(" ")}function ye(){return Oe("")}function V(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function Ze(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function m(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function bt(t){return Array.from(t.childNodes)}function yt(t,e){e=""+e,t.data!==e&&(t.data=e)}function Ke(t,e){t.value=e??""}function wt(t,e,n,r){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}function R(t,e,n){t.classList[n?"add":"remove"](e)}function vt(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,r,e),s}let le;function se(t){le=t}function ze(){if(!le)throw new Error("Function called outside component initialization");return le}function Re(t){ze().$$.on_mount.push(t)}function kt(t){ze().$$.on_destroy.push(t)}function Et(){const t=ze();return(e,n,{cancelable:r=!1}={})=>{const s=t.$$.callbacks[e];if(s){const o=vt(e,n,{cancelable:r});return s.slice().forEach(l=>{l.call(t,o)}),!o.defaultPrevented}return!0}}const Z=[],J=[];let x=[];const Be=[],xe=Promise.resolve();let Ne=!1;function et(){Ne||(Ne=!0,xe.then(tt))}function Pe(){return et(),xe}function De(t){x.push(t)}const Ee=new Set;let Q=0;function tt(){if(Q!==0)return;const t=le;do{try{for(;Q<Z.length;){const e=Z[Q];Q++,se(e),It(e.$$)}}catch(e){throw Z.length=0,Q=0,e}for(se(null),Z.length=0,Q=0;J.length;)J.pop()();for(let e=0;e<x.length;e+=1){const n=x[e];Ee.has(n)||(Ee.add(n),n())}x.length=0}while(Z.length);for(;Be.length;)Be.pop()();Ne=!1,Ee.clear(),se(t)}function It(t){if(t.fragment!==null){t.update(),H(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(De)}}function Nt(t){const e=[],n=[];x.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),x=e}const pe=new Set;let W;function ge(){W={r:0,c:[],p:W}}function me(){W.r||H(W.c),W=W.p}function F(t,e){t&&t.i&&(pe.delete(t),t.i(e))}function U(t,e,n,r){if(t&&t.o){if(pe.has(t))return;pe.add(t),W.c.push(()=>{pe.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function Se(t,e){U(t,1,1,()=>{e.delete(t.key)})}function Fe(t,e,n,r,s,o,l,a,_,i,u,h){let d=t.length,f=o.length,p=d;const b={};for(;p--;)b[t[p].key]=p;const g=[],w=new Map,D=new Map,E=[];for(p=f;p--;){const v=h(s,o,p),C=n(v);let S=l.get(C);S?r&&E.push(()=>S.p(v,e)):(S=i(C,v),S.c()),w.set(C,g[p]=S),C in b&&D.set(C,Math.abs(p-b[C]))}const G=new Set,$=new Set;function j(v){F(v,1),v.m(a,u),l.set(v.key,v),u=v.first,f--}for(;d&&f;){const v=g[f-1],C=t[d-1],S=v.key,O=C.key;v===C?(u=v.first,d--,f--):w.has(O)?!l.has(S)||G.has(S)?j(v):$.has(O)?d--:D.get(S)>D.get(O)?($.add(S),j(v)):(G.add(O),d--):(_(C,l),d--)}for(;d--;){const v=t[d];w.has(v.key)||_(v,l)}for(;f;)j(g[f-1]);return H(E),g}function ce(t){t&&t.c()}function ee(t,e,n,r){const{fragment:s,after_update:o}=t.$$;s&&s.m(e,n),r||De(()=>{const l=t.$$.on_mount.map(Qe).filter(Ce);t.$$.on_destroy?t.$$.on_destroy.push(...l):H(l),t.$$.on_mount=[]}),o.forEach(De)}function te(t,e){const n=t.$$;n.fragment!==null&&(Nt(n.after_update),H(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Dt(t,e){t.$$.dirty[0]===-1&&(Z.push(t),et(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Le(t,e,n,r,s,o,l,a=[-1]){const _=le;se(t);const i=t.$$={fragment:null,ctx:[],props:o,update:q,not_equal:s,bound:Ue(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(_?_.$$.context:[])),callbacks:Ue(),dirty:a,skip_bound:!1,root:e.target||_.$$.root};l&&l(i.root);let u=!1;if(i.ctx=n?n(t,e.props||{},(h,d,...f)=>{const p=f.length?f[0]:d;return i.ctx&&s(i.ctx[h],i.ctx[h]=p)&&(!i.skip_bound&&i.bound[h]&&i.bound[h](p),u&&Dt(t,h)),d}):[],i.update(),u=!0,H(i.before_update),i.fragment=r?r(i.ctx):!1,e.target){if(e.hydrate){const h=bt(e.target);i.fragment&&i.fragment.l(h),h.forEach(L)}else i.fragment&&i.fragment.c();e.intro&&F(t.$$.fragment),ee(t,e.target,e.anchor,e.customElement),tt()}se(_)}class Te{$destroy(){te(this,1),this.$destroy=q}$on(e,n){if(!Ce(n))return q;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!mt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Y=[];function ue(t,e=q){let n;const r=new Set;function s(a){if(be(t,a)&&(t=a,n)){const _=!Y.length;for(const i of r)i[1](),Y.push(i,t);if(_){for(let i=0;i<Y.length;i+=2)Y[i][0](Y[i+1]);Y.length=0}}}function o(a){s(a(t))}function l(a,_=q){const i=[a,_];return r.add(i),r.size===1&&(n=e(s)||q),a(t),()=>{r.delete(i),r.size===0&&n&&(n(),n=null)}}return{set:s,update:o,subscribe:l}}class he{constructor(e,n="",r=[]){this.id=e,this.markup=ue(n),this.children=ue(r)}add(e){K(this.children).includes(e.id)||this.children.set([...K(this.children),e.id])}}const qe=2;class ae{constructor(){var e=new he(0);this.notes={0:e},this.uID=1,this.version=qe}reset(){var e=new he(0);this.notes={0:e},this.uID=1}loadFromJSON(e){var n;for(n in e.notes){var r=e.notes[n],s=new he(n);s.children.set(r.children),s.markup.set(r.markup),this.notes[n]=s}}getCopyForDownload(){let e=(function(r){let s=(function(o,l){l[o.id]||(l[o.id]={id:o.id,markup:K(o.markup),children:K(o.children)},K(o.children).forEach((function(a){s(this.notes[a],l)}).bind(this)))}).bind(this);return s(this.notes[0],r),r}).bind(this),n={version:this.version,notes:{}};return e(n.notes),n}addNewChild({parent:e}){var n=this.getNewNote();return e.add(n),n}getNoteByID(e){return this.notes[e]}getNextUID(){for(;this.uID in this.notes;)this.uID++;return this.uID}swapPlaces(e,n,r){for(var s=K(e.children),o=0;o<s.length;o++)if([n.id,r.id].includes(s[o])){[s[o],s[o+1]]=[s[o+1],s[o]];return}}getNewNote(){var e=this.getNextUID(),n=new he(e);return this.notes[e]=n,n}getRoot(){var e=this.notes[0];if(!e)throw new Error("no root found");return e}Merge(e){var n=e.notes[0],r=0,s=(function(){return r+=1,!(r in this.notes)&&!(r in e.notes)?r:s()}).bind(this),o;for(var o in e.notes){var l=s();e.editNoteId(+o,l)}this.notes={...this.notes,...e.notes};var a=K(this.getRoot().children).length==0;return a?K(n.children).forEach(_=>{this.getRoot().add(this.notes[_])}):this.getRoot().add(n),n}editNoteId(e,n){var r=this.notes[e];r.id=n,delete this.notes[e],this.notes[n]=r;var s;for(s in this.notes){var r=this.notes[s];r.children.set(K(r.children).map(l=>l==e?n:l)),r.markup.set(String(K(r.markup)).replace(ae.GetNoteLinkOpeningTag(e),ae.GetNoteLinkOpeningTag(n)))}}Update(){for(this.version||(this.version=1);this.version<qe;)this.UpgradeByOneVersion()}UpgradeByOneVersion(){switch(this.version){}this.version++}static GetNoteLinkOpeningTag(e){return`<a id="${e}" href="#0">`}swapNotes(e,n,r){var s=K(e.children).map(function(o){return o==n.id?r.id:o==r.id?n.id:o});e.children.set(s)}}let oe=new ae,St=0;const Ft=function(){return St++},re=ue(null),_e=ue(null),ie=ue([]),Ie={copiedInstances:[]},Ct={MIN_TEXTBOX_HEIGHT:50};function Ge(t,e,n){const r=t.slice();return r[2]=e[n],r[44]=e,r[45]=n,r}function He(t,e,n){const r=t.slice();return r[2]=e[n],r[46]=e,r[45]=n,r}function $e(t,e,n){const r=t.slice();return r[2]=e[n],r[47]=e,r[45]=n,r}function Ot(t){let e,n=[],r=new Map,s,o,l,a=t[12];const _=i=>i[2];for(let i=0;i<a.length;i+=1){let u=$e(t,a,i),h=_(u);r.set(h,n[i]=je(h,u))}return{c(){e=z("div");for(let i=0;i<n.length;i+=1)n[i].c();m(e,"id","notepad"),m(e,"class","svelte-9z2dqz"),R(e,"isFocused",t[9])},m(i,u){A(i,e,u);for(let h=0;h<n.length;h+=1)n[h]&&n[h].m(e,null);s=!0,o||(l=V(e,"click",Ze(t[29])),o=!0)},p(i,u){u[0]&790594&&(a=i[12],ge(),n=Fe(n,u,_,1,i,a,r,e,Se,je,null,$e),me()),(!s||u[0]&512)&&R(e,"isFocused",i[9])},i(i){if(!s){for(let u=0;u<a.length;u+=1)F(n[u]);s=!0}},o(i){for(let u=0;u<n.length;u+=1)U(n[u]);s=!1},d(i){i&&L(e);for(let u=0;u<n.length;u+=1)n[u].d();o=!1,l()}}}function je(t,e){let n,r,s=e[45],o;const l=()=>e[27](r,s),a=()=>e[27](null,s);let _={noteId:e[2]};return r=new we({props:_}),l(),r.$on("SwapChildren",e[18]),r.$on("DeleteChild",e[19]),r.$on("Focus",e[28]),{key:t,first:null,c(){n=ye(),ce(r.$$.fragment),this.first=n},m(i,u){A(i,n,u),ee(r,i,u),o=!0},p(i,u){e=i,s!==e[45]&&(a(),s=e[45],l());const h={};u[0]&4096&&(h.noteId=e[2]),r.$set(h)},i(i){o||(F(r.$$.fragment,i),o=!0)},o(i){U(r.$$.fragment,i),o=!1},d(i){i&&L(n),a(),te(r,i)}}}function zt(t){let e,n,r=t[3]?"v":">",s,o,l,a,_,i,u,h;function d(g,w){return g[10]?Tt:Lt}let f=d(t),p=f(t),b=t[4]&&Je(t);return{c(){e=z("div"),n=z("button"),s=Oe(r),o=X(),l=z("span"),p.c(),a=X(),b&&b.c(),_=ye(),m(n,"id","toggleButton"),m(n,"class","svelte-9z2dqz"),R(n,"boldText",t[12].length>0),m(l,"id","text"),m(l,"class","svelte-9z2dqz"),m(e,"id","topRow"),m(e,"class","svelte-9z2dqz")},m(g,w){A(g,e,w),M(e,n),M(n,s),M(e,o),M(e,l),p.m(l,null),A(g,a,w),b&&b.m(g,w),A(g,_,w),i=!0,u||(h=[V(n,"click",t[30]),V(l,"click",Ze(t[33]))],u=!0)},p(g,w){(!i||w[0]&8)&&r!==(r=g[3]?"v":">")&&yt(s,r),(!i||w[0]&4096)&&R(n,"boldText",g[12].length>0),f===(f=d(g))&&p?p.p(g,w):(p.d(1),p=f(g),p&&(p.c(),p.m(l,null))),g[4]?b?(b.p(g,w),w[0]&16&&F(b,1)):(b=Je(g),b.c(),F(b,1),b.m(_.parentNode,_)):b&&(ge(),U(b,1,1,()=>{b=null}),me())},i(g){i||(F(b),i=!0)},o(g){U(b),i=!1},d(g){g&&L(e),p.d(),g&&L(a),b&&b.d(g),g&&L(_),u=!1,H(h)}}}function Lt(t){let e;return{c(){e=z("span")},m(n,r){A(n,e,r),e.innerHTML=t[13]},p(n,r){r[0]&8192&&(e.innerHTML=n[13])},d(n){n&&L(e)}}}function Tt(t){let e,n,r;return{c(){e=z("textarea"),m(e,"class","svelte-9z2dqz")},m(s,o){A(s,e,o),t[31](e),Ke(e,t[13]),n||(r=[V(e,"input",t[32]),V(e,"input",t[20])],n=!0)},p(s,o){o[0]&8192&&Ke(e,s[13])},d(s){s&&L(e),t[31](null),n=!1,H(r)}}}function Je(t){let e,n=[],r=new Map,s,o=[],l=new Map,a,_=t[12];const i=d=>d[2];for(let d=0;d<_.length;d+=1){let f=He(t,_,d),p=i(f);r.set(p,n[d]=We(p,f))}let u=t[8];const h=d=>d[2];for(let d=0;d<u.length;d+=1){let f=Ge(t,u,d),p=h(f);l.set(p,o[d]=Xe(p,f))}return{c(){e=z("div");for(let d=0;d<n.length;d+=1)n[d].c();s=X();for(let d=0;d<o.length;d+=1)o[d].c();m(e,"id","childContainer"),m(e,"class","svelte-9z2dqz"),R(e,"hidden",!t[3])},m(d,f){A(d,e,f);for(let p=0;p<n.length;p+=1)n[p]&&n[p].m(e,null);M(e,s);for(let p=0;p<o.length;p+=1)o[p]&&o[p].m(e,null);a=!0},p(d,f){f[0]&790594&&(_=d[12],ge(),n=Fe(n,f,i,1,d,_,r,e,Se,We,s,He),me()),f[0]&524674&&(u=d[8],ge(),o=Fe(o,f,h,1,d,u,l,e,Se,Xe,null,Ge),me()),(!a||f[0]&8)&&R(e,"hidden",!d[3])},i(d){if(!a){for(let f=0;f<_.length;f+=1)F(n[f]);for(let f=0;f<u.length;f+=1)F(o[f]);a=!0}},o(d){for(let f=0;f<n.length;f+=1)U(n[f]);for(let f=0;f<o.length;f+=1)U(o[f]);a=!1},d(d){d&&L(e);for(let f=0;f<n.length;f+=1)n[f].d();for(let f=0;f<o.length;f+=1)o[f].d()}}}function We(t,e){let n,r,s=e[45],o;const l=()=>e[34](r,s),a=()=>e[34](null,s);let _={noteId:e[2]};return r=new we({props:_}),l(),r.$on("SwapChildren",e[18]),r.$on("DeleteChild",e[19]),r.$on("Focus",e[35]),{key:t,first:null,c(){n=ye(),ce(r.$$.fragment),this.first=n},m(i,u){A(i,n,u),ee(r,i,u),o=!0},p(i,u){e=i,s!==e[45]&&(a(),s=e[45],l());const h={};u[0]&4096&&(h.noteId=e[2]),r.$set(h)},i(i){o||(F(r.$$.fragment,i),o=!0)},o(i){U(r.$$.fragment,i),o=!1},d(i){i&&L(n),a(),te(r,i)}}}function Xe(t,e){let n,r,s=e[45],o;const l=()=>e[36](r,s),a=()=>e[36](null,s);let _={noteId:e[2],isReference:!0};return r=new we({props:_}),l(),r.$on("DeleteChild",e[19]),r.$on("Focus",e[37]),{key:t,first:null,c(){n=ye(),ce(r.$$.fragment),this.first=n},m(i,u){A(i,n,u),ee(r,i,u),o=!0},p(i,u){e=i,s!==e[45]&&(a(),s=e[45],l());const h={};u[0]&256&&(h.noteId=e[2]),r.$set(h)},i(i){o||(F(r.$$.fragment,i),o=!0)},o(i){U(r.$$.fragment,i),o=!1},d(i){i&&L(n),a(),te(r,i)}}}function Mt(t){let e,n,r,s=t[15]&&Ot(t),o=!t[15]&&zt(t);return{c(){e=z("div"),s&&s.c(),n=X(),o&&o.c(),m(e,"id","note "+t[14].id),m(e,"class","noteWrapper svelte-9z2dqz"),m(e,"style",t[15]?"height: 100%;":""),R(e,"selected",t[11]),R(e,"isFocused",t[9]),R(e,"referenceContainer",t[0])},m(l,a){A(l,e,a),s&&s.m(e,null),M(e,n),o&&o.m(e,null),r=!0},p(l,a){l[15]&&s.p(l,a),l[15]||o.p(l,a),(!r||a[0]&2048)&&R(e,"selected",l[11]),(!r||a[0]&512)&&R(e,"isFocused",l[9]),(!r||a[0]&1)&&R(e,"referenceContainer",l[0])},i(l){r||(F(s),F(o),r=!0)},o(l){U(s),U(o),r=!1},d(l){l&&L(e),s&&s.d(),o&&o.d()}}}function At(t,e,n){let r,s,o,l,a,_,i,u;ne(t,ie,c=>n(24,l=c)),ne(t,_e,c=>n(25,a=c)),ne(t,re,c=>n(26,_=c));const h=Et(),d=function(){h("DeleteChild",{target:D,isFocused:fe})},f=Ft();let{noteId:p}=e,{isReference:b=!1}=e,w=oe.notes[p];const D={note:w,noteId:p,instanceId:f,Delete:d};let E,G=[],$=[],j=[];const v=p==0;let C=w.markup;ne(t,C,c=>n(13,u=c));let S=w.children;ne(t,S,c=>n(12,i=c));let O=!1,fe=!1,{Focus:P=function(c=!1){if(_!=D&&_e.set(null),re.set(D),v){c||ie.set([]);return}else ve(D,c)}}=e;D.Focus=P;let ve=function(c,y){let T=y?[...l,c]:[c];ie.set(T)},nt=function(c){let{child_to_swap:y,moveUp:T}=c.detail;var I=i.indexOf(y),k=I+(T?-1:1),N=k>=0&&k<i.length;if(N){let B=[...i];[B[I],B[k]]=[B[k],B[I]],S.set(B)}},rt=function(c){let{target:y,isFocused:T}=c.detail;if(T){var I=de();let N=I.indexOf(y);if(N==1)P();else{var k=I[N-1];re.set(k),ie.set([k])}}n(8,j=j.filter(N=>N!=y.instanceId)),S.set([...i.filter(N=>N!=y.note.id)])};const de=function(){var c=[D];if(O||v){var y=[...G,...$];y.forEach(T=>{if(T!=null){var I=[];I=T.getSortedGenespan(),c=c.concat(I)}})}return c};let Me=function(c){if(fe){if(c.stopImmediatePropagation(),!r)switch(c.key){case"ArrowUp":c.shiftKey&&h("SwapChildren",{child_to_swap:w.id,moveUp:!0});break;case"ArrowDown":c.shiftKey&&h("SwapChildren",{child_to_swap:w.id,moveUp:!1});break;case"ArrowLeft":h("Focus",{keepSelection:c.ctrlKey});break;case"Insert":c.preventDefault();var y=oe.addNewChild({parent:w});n(3,O=!0),c.ctrlKey||Pe().then(()=>{de().forEach(N=>{N.note==y&&(re.set(N),ie.set([N]))})});break;case"Tab":c.preventDefault(),n(3,O=!O);break;case"Enter":v||(c.preventDefault(),_e.set(D),Pe().then(()=>{E.focus(),ve(D,!1),Ae()}));break;case"i":if(c.ctrlKey)debugger;break;case"c":c.ctrlKey&&(Ie.copiedInstances=[...l]);break;case"x":c.ctrlKey&&(Ie.copiedInstances=[...l],l.forEach(k=>k.Delete()));break;case"v":c.ctrlKey&&(Ie.copiedInstances.forEach(function(k){var N=i.includes(k.noteId);N||w.add(k.note)}),i.length>0&&n(3,O=!0));break;case"Alt":c.preventDefault();break}if(r)switch(c.key){case"Enter":break;case"Alt":c.preventDefault(),_e.set(null);break;case"Tab":c.preventDefault();var T=E.selectionStart,I=E.selectionEnd;n(5,E.value=E.value.substring(0,T)+"	"+E.value.substring(I),E),n(5,E.selectionStart=n(5,E.selectionEnd=T+1,E),E)}}};Re(()=>{window.addEventListener("keydown",Me)}),kt(()=>{window.removeEventListener("keydown",Me)});function Ae(){var c=Math.max(Ct.MIN_TEXTBOX_HEIGHT,E.scrollHeight)+"px";n(5,E.style.height=c,E)}v&&(Re(P),window.addEventListener("keydown",function(y){let T=function(I){for(var k=de(),N,B=0;B<k.length;B++){var pt=k[B];if(pt==_){N=B;break}}var ke=N+(I?-1:1),gt=ke>=0&&ke<k.length;return gt?k[ke]:null};if((y.key=="ArrowUp"||y.key=="ArrowDown")&&a==null&&(y.preventDefault(),!y.shiftKey)){let I=y.key=="ArrowUp",k=T(I);k!=null&&(re.set(k),ve(k,y.ctrlKey))}y.key=="Delete"&&l.forEach(I=>{I.Delete()})}));function it(c,y){J[c?"unshift":"push"](()=>{G[y]=c,n(6,G)})}const st=c=>{P(c.detail.keepSelection)},ot=c=>{P(c.ctrlKey)},lt=()=>{n(3,O=!O)};function ct(c){J[c?"unshift":"push"](()=>{E=c,n(5,E)})}function ut(){u=this.value,C.set(u)}const at=c=>{P(c.ctrlKey)};function ft(c,y){J[c?"unshift":"push"](()=>{G[y]=c,n(6,G)})}const dt=c=>{P(c.detail.keepSelection)};function ht(c,y){J[c?"unshift":"push"](()=>{$[y]=c,n(7,$)})}const _t=c=>{P(c.detail.keepSelection)};return t.$$set=c=>{"noteId"in c&&n(2,p=c.noteId),"isReference"in c&&n(0,b=c.isReference),"Focus"in c&&n(1,P=c.Focus)},t.$$.update=()=>{t.$$.dirty[0]&41943040&&n(10,r=a==D),t.$$.dirty[0]&24&&n(4,s=O||s),t.$$.dirty[0]&75497472&&n(9,fe=_===D),t.$$.dirty[0]&25165824&&n(11,o=l.includes(D))},[b,P,p,O,s,E,G,$,j,fe,r,o,i,u,w,v,C,S,nt,rt,Ae,f,de,D,l,a,_,it,st,ot,lt,ct,ut,at,ft,dt,ht,_t]}class we extends Te{constructor(e){super(),Le(this,e,At,Mt,be,{instanceId:21,noteId:2,isReference:0,Focus:1,getSortedGenespan:22},null,[-1,-1])}get instanceId(){return this.$$.ctx[21]}get getSortedGenespan(){return this.$$.ctx[22]}}function Ut(t){let e,n,r,s,o,l,a,_;return{c(){e=z("div"),n=z("button"),n.textContent="Download",r=X(),s=z("label"),s.textContent="Upload",o=X(),l=z("input"),m(n,"id","download_btn"),m(n,"class","file-button svelte-e1fw06"),m(s,"id","upload_btn"),m(s,"class","file-button svelte-e1fw06"),m(s,"for","file"),m(l,"id","file"),m(l,"type","file"),m(l,"accept",".tnp"),wt(l,"display","none"),m(e,"id","MenuBar"),m(e,"class","svelte-e1fw06")},m(i,u){A(i,e,u),M(e,n),M(e,r),M(e,s),M(e,o),M(e,l),t[3](l),a||(_=[V(n,"click",function(){Ce(t[0])&&t[0].apply(this,arguments)}),V(l,"change",t[2])],a=!0)},p(i,[u]){t=i},i:q,o:q,d(i){i&&L(e),t[3](null),a=!1,H(_)}}}function Ve(t){return t.slice(0,-4)}function Kt(t,e,n){let r,s=async function(i){var u=K(oe.notes[0].children).length==0,h=r.files.length>0;h&&u&&(document.title=Ve(r.files[0].name));for(var d=0;d<r.files.length;d++){var f=r.files[d];await o(f)}n(1,r.value="",r)},o=async function(i){var u=await i.text(),h=new ae;h.loadFromJSON(JSON.parse(u)),h.Update();var d=h.notes[0];d.markup.set(i.name),oe.Merge(h)},{download:l=function(){var i=oe.getCopyForDownload(),u=JSON.stringify(i),h=new Blob([u],{type:"application/octet-binary"});a(h),document.title.endsWith("*")&&(document.title=Ve(document.title))}}=e,a=function(i){var u=document.createElement("a");u.setAttribute("href",URL.createObjectURL(i)),u.setAttribute("download",document.title+".tnp"),u.click()};document.addEventListener("keydown",i=>{let u=function(){var h=document.title;h[0]=="*"&&(document.title=h.substring(1,h.length))};i.key=="d"&&i.ctrlKey&&(i.preventDefault(),l()),u()}),window.addEventListener("beforeunload",function(i){document.title.endsWith("*")&&i.preventDefault()});function _(i){J[i?"unshift":"push"](()=>{r=i,n(1,r)})}return t.$$set=i=>{"download"in i&&n(0,l=i.download)},[l,r,s,_]}class Rt extends Te{constructor(e){super(),Le(this,e,Kt,Ut,be,{download:0})}}function Bt(t){let e,n,r,s,o,l;return r=new Rt({}),o=new we({props:{noteId:0}}),{c(){e=z("main"),n=z("div"),ce(r.$$.fragment),s=X(),ce(o.$$.fragment),m(n,"id","MenubarContainer"),m(n,"class","svelte-1l4rrhz"),m(e,"data-testid","my-element"),m(e,"class","svelte-1l4rrhz")},m(a,_){A(a,e,_),M(e,n),ee(r,n,null),M(e,s),ee(o,e,null),l=!0},p:q,i(a){l||(F(r.$$.fragment,a),F(o.$$.fragment,a),l=!0)},o(a){U(r.$$.fragment,a),U(o.$$.fragment,a),l=!1},d(a){a&&L(e),te(r),te(o)}}}class Pt extends Te{constructor(e){super(),Le(this,e,null,Bt,be,{})}}new Pt({target:document.getElementById("app")});
