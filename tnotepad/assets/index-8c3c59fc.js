(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function H(){}function nt(t){return t()}function Ge(){return Object.create(null)}function z(t){t.forEach(nt)}function Oe(t){return typeof t=="function"}function _e(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Ct(t){return Object.keys(t).length===0}function st(t,...e){if(t==null)return H;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function K(t){let e;return st(t,n=>e=n)(),e}function oe(t,e,n){t.$$.on_destroy.push(st(e,n))}function w(t,e){t.appendChild(e)}function T(t,e,n){t.insertBefore(e,n||null)}function D(t){t.parentNode&&t.parentNode.removeChild(t)}function Dt(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function E(t){return document.createElement(t)}function se(t){return document.createTextNode(t)}function R(){return se(" ")}function ye(){return se("")}function W(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function it(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function b(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function St(t){return Array.from(t.childNodes)}function rt(t,e){e=""+e,t.data!==e&&(t.data=e)}function Xe(t,e){t.value=e??""}function At(t,e,n,s){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,s?"important":"")}function F(t,e,n){t.classList[n?"add":"remove"](e)}function Ft(t,e,{bubbles:n=!1,cancelable:s=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,s,e),i}let fe;function ue(t){fe=t}function Le(){if(!fe)throw new Error("Function called outside component initialization");return fe}function De(t){Le().$$.on_mount.push(t)}function Mt(t){Le().$$.on_destroy.push(t)}function Tt(){const t=Le();return(e,n,{cancelable:s=!1}={})=>{const i=t.$$.callbacks[e];if(i){const o=Ft(e,n,{cancelable:s});return i.slice().forEach(l=>{l.call(t,o)}),!o.defaultPrevented}return!0}}const te=[],q=[];let ne=[];const je=[],ot=Promise.resolve();let Fe=!1;function lt(){Fe||(Fe=!0,ot.then(ct))}function Se(){return lt(),ot}function Me(t){ne.push(t)}const Ae=new Set;let x=0;function ct(){if(x!==0)return;const t=fe;do{try{for(;x<te.length;){const e=te[x];x++,ue(e),$t(e.$$)}}catch(e){throw te.length=0,x=0,e}for(ue(null),te.length=0,x=0;q.length;)q.pop()();for(let e=0;e<ne.length;e+=1){const n=ne[e];Ae.has(n)||(Ae.add(n),n())}ne.length=0}while(te.length);for(;je.length;)je.pop()();Fe=!1,Ae.clear(),ue(t)}function $t(t){if(t.fragment!==null){t.update(),z(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Me)}}function Ot(t){const e=[],n=[];ne.forEach(s=>t.indexOf(s)===-1?e.push(s):n.push(s)),n.forEach(s=>s()),ne=e}const we=new Set;let Q;function de(){Q={r:0,c:[],p:Q}}function he(){Q.r||z(Q.c),Q=Q.p}function C(t,e){t&&t.i&&(we.delete(t),t.i(e))}function M(t,e,n,s){if(t&&t.o){if(we.has(t))return;we.add(t),Q.c.push(()=>{we.delete(t),s&&(n&&t.d(1),s())}),t.o(e)}else s&&s()}function Te(t,e){M(t,1,1,()=>{e.delete(t.key)})}function $e(t,e,n,s,i,o,l,a,p,r,c,h){let f=t.length,d=o.length,_=f;const g={};for(;_--;)g[t[_].key]=_;const m=[],v=new Map,S=new Map,U=[];for(_=d;_--;){const k=h(i,o,_),$=n(k);let O=l.get($);O?s&&U.push(()=>O.p(k,e)):(O=r($,k),O.c()),v.set($,m[_]=O),$ in g&&S.set($,Math.abs(_-g[$]))}const G=new Set,J=new Set;function X(k){C(k,1),k.m(a,c),l.set(k.key,k),c=k.first,d--}for(;f&&d;){const k=m[d-1],$=t[f-1],O=k.key,L=$.key;k===$?(c=k.first,f--,d--):v.has(L)?!l.has(O)||G.has(O)?X(k):J.has(L)?f--:S.get(O)>S.get(L)?(J.add(O),X(k)):(G.add(L),f--):(p($,l),f--)}for(;f--;){const k=t[f];v.has(k.key)||p(k,l)}for(;d;)X(m[d-1]);return z(U),m}function ie(t){t&&t.c()}function Y(t,e,n,s){const{fragment:i,after_update:o}=t.$$;i&&i.m(e,n),s||Me(()=>{const l=t.$$.on_mount.map(nt).filter(Oe);t.$$.on_destroy?t.$$.on_destroy.push(...l):z(l),t.$$.on_mount=[]}),o.forEach(Me)}function Z(t,e){const n=t.$$;n.fragment!==null&&(Ot(n.after_update),z(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Lt(t,e){t.$$.dirty[0]===-1&&(te.push(t),lt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ke(t,e,n,s,i,o,l,a=[-1]){const p=fe;ue(t);const r=t.$$={fragment:null,ctx:[],props:o,update:H,not_equal:i,bound:Ge(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(p?p.$$.context:[])),callbacks:Ge(),dirty:a,skip_bound:!1,root:e.target||p.$$.root};l&&l(r.root);let c=!1;if(r.ctx=n?n(t,e.props||{},(h,f,...d)=>{const _=d.length?d[0]:f;return r.ctx&&i(r.ctx[h],r.ctx[h]=_)&&(!r.skip_bound&&r.bound[h]&&r.bound[h](_),c&&Lt(t,h)),f}):[],r.update(),c=!0,z(r.before_update),r.fragment=s?s(r.ctx):!1,e.target){if(e.hydrate){const h=St(e.target);r.fragment&&r.fragment.l(h),h.forEach(D)}else r.fragment&&r.fragment.c();e.intro&&C(t.$$.fragment),Y(t,e.target,e.anchor,e.customElement),ct()}ue(p)}class Ee{$destroy(){Z(this,1),this.$destroy=H}$on(e,n){if(!Oe(n))return H;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const i=s.indexOf(n);i!==-1&&s.splice(i,1)}}$set(e){this.$$set&&!Ct(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ee=[];function pe(t,e=H){let n;const s=new Set;function i(a){if(_e(t,a)&&(t=a,n)){const p=!ee.length;for(const r of s)r[1](),ee.push(r,t);if(p){for(let r=0;r<ee.length;r+=2)ee[r][0](ee[r+1]);ee.length=0}}}function o(a){i(a(t))}function l(a,p=H){const r=[a,p];return s.add(r),s.size===1&&(n=e(i)||H),a(t),()=>{s.delete(r),s.size===0&&n&&(n(),n=null)}}return{set:i,update:o,subscribe:l}}class be{constructor(e,n="",s=[]){this.id=e,this.markup=pe(n),this.children=pe(s)}add(e){K(this.children).includes(e.id)||this.children.set([...K(this.children),e.id])}}const We=2;class re{constructor(){var e=new be(0);this.notes={0:e},this.uID=1,this.version=We}reset(){var e=new be(0);this.notes={0:e},this.uID=1}loadFromJSON(e){var n;for(n in e.notes){var s=e.notes[n],i=new be(n);i.children.set(s.children),i.markup.set(s.markup),this.notes[n]=i}}getCopyForDownload(){let e=(function(s){let i=(function(o,l){l[o.id]||(l[o.id]={id:o.id,markup:K(o.markup),children:K(o.children)},K(o.children).forEach((function(a){i(this.notes[a],l)}).bind(this)))}).bind(this);return i(this.notes[0],s),s}).bind(this),n={version:this.version,notes:{}};return e(n.notes),n}addNewChild({parent:e}){var n=this.getNewNote();return e.add(n),n}getNoteByID(e){return this.notes[e]}getNextUID(){for(;this.uID in this.notes;)this.uID++;return this.uID}swapPlaces(e,n,s){for(var i=K(e.children),o=0;o<i.length;o++)if([n.id,s.id].includes(i[o])){[i[o],i[o+1]]=[i[o+1],i[o]];return}}getNewNote(){var e=this.getNextUID(),n=new be(e);return this.notes[e]=n,n}getRoot(){var e=this.notes[0];if(!e)throw new Error("no root found");return e}Merge(e){var n=e.notes[0],s=0,i=(function(){return s+=1,!(s in this.notes)&&!(s in e.notes)?s:i()}).bind(this),o;for(var o in e.notes){var l=i();e.editNoteId(+o,l)}this.notes={...this.notes,...e.notes};var a=K(this.getRoot().children).length==0;return a?K(n.children).forEach(p=>{this.getRoot().add(this.notes[p])}):this.getRoot().add(n),n}editNoteId(e,n){var s=this.notes[e];s.id=n,delete this.notes[e],this.notes[n]=s;var i;for(i in this.notes){var s=this.notes[i];s.children.set(K(s.children).map(l=>l==e?n:l)),s.markup.set(String(K(s.markup)).replace(re.GetNoteLinkOpeningTag(e),re.GetNoteLinkOpeningTag(n)))}}Update(){for(this.version||(this.version=1);this.version<We;)this.UpgradeByOneVersion()}UpgradeByOneVersion(){switch(this.version){}this.version++}static GetNoteLinkOpeningTag(e){return`<a id="${e}" href="#0">`}swapNotes(e,n,s){var i=K(e.children).map(function(o){return o==n.id?s.id:o==s.id?n.id:o});e.children.set(i)}}let ae=new re,Ut=0;const Ht=function(){return Ut++},le=pe(null),ve=pe(null),ce=pe([]),V={copiedInstances:[],copyMode:"copy"},Rt={MIN_TEXTBOX_HEIGHT:50};function ze(t,e,n){const s=t.slice();return s[2]=e[n],s[50]=e,s[51]=n,s}function Je(t,e,n){const s=t.slice();return s[2]=e[n],s[52]=e,s[51]=n,s}function Ve(t,e,n){const s=t.slice();return s[2]=e[n],s[53]=e,s[51]=n,s}function Kt(t){let e,n=[],s=new Map,i,o,l,a=t[5];const p=r=>r[2];for(let r=0;r<a.length;r+=1){let c=Ve(t,a,r),h=p(c);s.set(h,n[r]=qe(h,c))}return{c(){e=E("div");for(let r=0;r<n.length;r+=1)n[r].c();b(e,"id","notepad"),b(e,"class","svelte-mn0t42"),F(e,"isFocused",t[11])},m(r,c){T(r,e,c);for(let h=0;h<n.length;h+=1)n[h]&&n[h].m(e,null);i=!0,o||(l=W(e,"click",it(t[33])),o=!0)},p(r,c){c[0]&786722&&(a=r[5],de(),n=$e(n,c,p,1,r,a,s,e,Te,qe,null,Ve),he()),(!i||c[0]&2048)&&F(e,"isFocused",r[11])},i(r){if(!i){for(let c=0;c<a.length;c+=1)C(n[c]);i=!0}},o(r){for(let c=0;c<n.length;c+=1)M(n[c]);i=!1},d(r){r&&D(e);for(let c=0;c<n.length;c+=1)n[c].d();o=!1,l()}}}function qe(t,e){let n,s,i=e[51],o;const l=()=>e[31](s,i),a=()=>e[31](null,i);let p={noteId:e[2]};return s=new Ie({props:p}),l(),s.$on("SwapChildren",e[18]),s.$on("DeleteChild",e[19]),s.$on("Focus",e[32]),{key:t,first:null,c(){n=ye(),ie(s.$$.fragment),this.first=n},m(r,c){T(r,n,c),Y(s,r,c),o=!0},p(r,c){e=r,i!==e[51]&&(a(),i=e[51],l());const h={};c[0]&32&&(h.noteId=e[2]),s.$set(h)},i(r){o||(C(s.$$.fragment,r),o=!0)},o(r){M(s.$$.fragment,r),o=!1},d(r){r&&D(n),a(),Z(s,r)}}}function Bt(t){let e,n,s=t[3]?"v":">",i,o,l,a,p,r,c,h;function f(m,v){return m[12]?Gt:Pt}let d=f(t),_=d(t),g=t[4]&&Qe(t);return{c(){e=E("div"),n=E("button"),i=se(s),o=R(),l=E("span"),_.c(),a=R(),g&&g.c(),p=ye(),b(n,"id","toggleButton"),b(n,"class","svelte-mn0t42"),F(n,"boldText",t[5].length>0),b(l,"id","text"),b(l,"class","svelte-mn0t42"),b(e,"id","topRow"),b(e,"class","svelte-mn0t42")},m(m,v){T(m,e,v),w(e,n),w(n,i),w(e,o),w(e,l),_.m(l,null),T(m,a,v),g&&g.m(m,v),T(m,p,v),r=!0,c||(h=[W(n,"click",t[34]),W(l,"click",it(t[37]))],c=!0)},p(m,v){(!r||v[0]&8)&&s!==(s=m[3]?"v":">")&&rt(i,s),(!r||v[0]&32)&&F(n,"boldText",m[5].length>0),d===(d=f(m))&&_?_.p(m,v):(_.d(1),_=d(m),_&&(_.c(),_.m(l,null))),m[4]?g?(g.p(m,v),v[0]&16&&C(g,1)):(g=Qe(m),g.c(),C(g,1),g.m(p.parentNode,p)):g&&(de(),M(g,1,1,()=>{g=null}),he())},i(m){r||(C(g),r=!0)},o(m){M(g),r=!1},d(m){m&&D(e),_.d(),m&&D(a),g&&g.d(m),m&&D(p),c=!1,z(h)}}}function Pt(t){let e,n,s;return{c(){e=E("span")},m(i,o){T(i,e,o),e.innerHTML=t[6],n||(s=W(e,"click",t[20]),n=!0)},p(i,o){o[0]&64&&(e.innerHTML=i[6])},d(i){i&&D(e),n=!1,s()}}}function Gt(t){let e,n,s;return{c(){e=E("textarea"),b(e,"class","svelte-mn0t42")},m(i,o){T(i,e,o),t[35](e),Xe(e,t[6]),n||(s=[W(e,"input",t[36]),W(e,"input",t[21])],n=!0)},p(i,o){o[0]&64&&Xe(e,i[6])},d(i){i&&D(e),t[35](null),n=!1,z(s)}}}function Qe(t){let e,n=[],s=new Map,i,o=[],l=new Map,a,p=t[5];const r=f=>f[2];for(let f=0;f<p.length;f+=1){let d=Je(t,p,f),_=r(d);s.set(_,n[f]=Ye(_,d))}let c=t[10];const h=f=>f[2];for(let f=0;f<c.length;f+=1){let d=ze(t,c,f),_=h(d);l.set(_,o[f]=Ze(_,d))}return{c(){e=E("div");for(let f=0;f<n.length;f+=1)n[f].c();i=R();for(let f=0;f<o.length;f+=1)o[f].c();b(e,"id","childContainer"),b(e,"class","svelte-mn0t42"),F(e,"hidden",!t[3])},m(f,d){T(f,e,d);for(let _=0;_<n.length;_+=1)n[_]&&n[_].m(e,null);w(e,i);for(let _=0;_<o.length;_+=1)o[_]&&o[_].m(e,null);a=!0},p(f,d){d[0]&786722&&(p=f[5],de(),n=$e(n,d,r,1,f,p,s,e,Te,Ye,i,Je),he()),d[0]&525826&&(c=f[10],de(),o=$e(o,d,h,1,f,c,l,e,Te,Ze,null,ze),he()),(!a||d[0]&8)&&F(e,"hidden",!f[3])},i(f){if(!a){for(let d=0;d<p.length;d+=1)C(n[d]);for(let d=0;d<c.length;d+=1)C(o[d]);a=!0}},o(f){for(let d=0;d<n.length;d+=1)M(n[d]);for(let d=0;d<o.length;d+=1)M(o[d]);a=!1},d(f){f&&D(e);for(let d=0;d<n.length;d+=1)n[d].d();for(let d=0;d<o.length;d+=1)o[d].d()}}}function Ye(t,e){let n,s,i=e[51],o;const l=()=>e[38](s,i),a=()=>e[38](null,i);let p={noteId:e[2]};return s=new Ie({props:p}),l(),s.$on("SwapChildren",e[18]),s.$on("DeleteChild",e[19]),s.$on("Focus",e[39]),{key:t,first:null,c(){n=ye(),ie(s.$$.fragment),this.first=n},m(r,c){T(r,n,c),Y(s,r,c),o=!0},p(r,c){e=r,i!==e[51]&&(a(),i=e[51],l());const h={};c[0]&32&&(h.noteId=e[2]),s.$set(h)},i(r){o||(C(s.$$.fragment,r),o=!0)},o(r){M(s.$$.fragment,r),o=!1},d(r){r&&D(n),a(),Z(s,r)}}}function Ze(t,e){let n,s,i=e[51],o;const l=()=>e[40](s,i),a=()=>e[40](null,i);let p={noteId:e[2],isReference:!0};return s=new Ie({props:p}),l(),s.$on("DeleteChild",e[19]),s.$on("Focus",e[41]),{key:t,first:null,c(){n=ye(),ie(s.$$.fragment),this.first=n},m(r,c){T(r,n,c),Y(s,r,c),o=!0},p(r,c){e=r,i!==e[51]&&(a(),i=e[51],l());const h={};c[0]&1024&&(h.noteId=e[2]),s.$set(h)},i(r){o||(C(s.$$.fragment,r),o=!0)},o(r){M(s.$$.fragment,r),o=!1},d(r){r&&D(n),a(),Z(s,r)}}}function Xt(t){let e,n,s,i=t[15]&&Kt(t),o=!t[15]&&Bt(t);return{c(){e=E("div"),i&&i.c(),n=R(),o&&o.c(),b(e,"id","note "+t[14].id),b(e,"class","noteWrapper svelte-mn0t42"),b(e,"style",t[15]?"height: 100%;":""),F(e,"isSelected",t[13]),F(e,"isExpanded",t[3]),F(e,"isFocused",t[11]),F(e,"referenceContainer",t[0])},m(l,a){T(l,e,a),i&&i.m(e,null),w(e,n),o&&o.m(e,null),s=!0},p(l,a){l[15]&&i.p(l,a),l[15]||o.p(l,a),(!s||a[0]&8192)&&F(e,"isSelected",l[13]),(!s||a[0]&8)&&F(e,"isExpanded",l[3]),(!s||a[0]&2048)&&F(e,"isFocused",l[11]),(!s||a[0]&1)&&F(e,"referenceContainer",l[0])},i(l){s||(C(i),C(o),s=!0)},o(l){M(i),M(o),s=!1},d(l){l&&D(e),i&&i.d(),o&&o.d()}}}function xe(t,e){var n=t.selectionStart,s=t.selectionEnd;t.value=t.value.substring(0,n)+e+t.value.substring(s),t.selectionStart=t.selectionEnd=n+e.length}function jt(t){return t.endsWith("*")?t.slice(0,-1):t}function Wt(t,e,n){let s,i,o,l,a,p,r,c;oe(t,ce,u=>n(28,p=u)),oe(t,ve,u=>n(29,r=u)),oe(t,le,u=>n(30,c=u));const h=Tt(),f=function(){h("DeleteChild",{target:S,isFocused:ge})},d=Ht();let{noteId:_}=e,{isReference:g=!1}=e,v=ae.notes[_];const S={note:v,noteId:_,instanceId:d,Delete:f};let U,G=[],J=[],X=[];const k=_==0;let $=v.markup;oe(t,$,u=>n(6,a=u));let O=v.children;oe(t,O,u=>n(5,l=u));let L=!1;const Ue=function(){n(3,L=!0)},He=async function(u){if(!(u<=0)){await Se();var y=[...G,...J];y.forEach(N=>{N.Expand(),N.ExpandAll(u-1)})}};let ge=!1,{Focus:j=function(u=!1){if(c!=S&&ve.set(null),le.set(S),k){u||ce.set([]);return}else Ne(S,u)}}=e;S.Focus=j;let Ne=function(u,y){let N=y?[...p,u]:[u];ce.set(N)},ut=function(u){let{child_to_swap:y,moveUp:N}=u.detail;var I=l.indexOf(y),A=I+(N?-1:1),B=A>=0&&A<l.length;if(B){let P=[...l];[P[I],P[A]]=[P[A],P[I]],O.set(P)}},at=function(u){let{target:y,isFocused:N}=u.detail;if(N){var I=me();let B=I.indexOf(y);if(B==1)j();else{var A=I[B-1];le.set(A),ce.set([A])}}n(10,X=X.filter(B=>B!=y.instanceId)),O.set([...l.filter(B=>B!=y.note.id)])};const me=function(){var u=[S];if(L||k){var y=[...G,...J];y.forEach(N=>{if(N!=null){var I=[];I=N.getSortedGenespan(),u=u.concat(I)}})}return u};let Re=function(u){if(ge){if(u.stopImmediatePropagation(),!s)switch(u.key){case"ArrowUp":u.shiftKey&&h("SwapChildren",{child_to_swap:v.id,moveUp:!0});break;case"ArrowDown":u.shiftKey&&h("SwapChildren",{child_to_swap:v.id,moveUp:!1});break;case"ArrowLeft":h("Focus",{keepSelection:u.ctrlKey});break;case"Insert":u.preventDefault();var y=ae.addNewChild({parent:v});n(3,L=!0),u.ctrlKey||Se().then(()=>{me().forEach(I=>{I.note==y&&(le.set(I),ce.set([I]))})});break;case"Tab":u.preventDefault(),n(3,L=!L),u.shiftKey&&He(2);break;case"Enter":k||(u.preventDefault(),ve.set(S),Se().then(()=>{U.focus(),Ne(S,!1),Ke()}));break;case"i":if(u.ctrlKey)debugger;break;case"c":u.ctrlKey&&(V.copiedInstances=[...p],V.copyMode="copy");break;case"x":u.ctrlKey&&(V.copiedInstances=[...p],V.copyMode="cut");break;case"v":V.copiedInstances.forEach(function(N){var I=l.includes(N.noteId);I||(v.add(N.note),V.copyMode=="cut"&&N.Delete())}),l.length>0&&n(3,L=!0);break;case"Alt":u.preventDefault();break}if(s)switch(u.key){case"Enter":break;case"Alt":u.preventDefault(),ve.set(null);break;case"Tab":u.preventDefault(),xe(U,"	");break;case"v":if(u.ctrlKey&&V.copiedInstances.length>0){u.preventDefault();let N=V.copiedInstances[0].note,I=re.GetNoteLinkOpeningTag(N.id)+"</a>";xe(U,I),$.set(U.value)}}}};De(()=>{window.addEventListener("keydown",Re)}),Mt(()=>{window.removeEventListener("keydown",Re)});function ft(u){u.target.tagName==="A"&&(dt(+u.target.id),Ue())}function dt(u){X.includes(u)||l.includes(u)||n(10,X=[...X,u])}function Ke(){var u=Math.max(Rt.MIN_TEXTBOX_HEIGHT,U.scrollHeight)+"px";n(7,U.style.height=u,U)}k&&(De(j),window.addEventListener("keydown",function(y){let N=function(I){for(var A=me(),B,P=0;P<A.length;P++){var It=A[P];if(It==c){B=P;break}}var Ce=B+(I?-1:1),Nt=Ce>=0&&Ce<A.length;return Nt?A[Ce]:null};if((y.key=="ArrowUp"||y.key=="ArrowDown")&&r==null&&(y.preventDefault(),!y.shiftKey)){let I=y.key=="ArrowUp",A=N(I);A!=null&&(le.set(A),Ne(A,y.ctrlKey))}y.key=="Delete"&&p.forEach(I=>{I.Delete()})}));var Be=function(){document.title.endsWith("*")||(document.title=document.title+"*")};k&&De(()=>{document.title=jt(document.title)});function Pe(){h("CloseHelp")}function ht(u,y){q[u?"unshift":"push"](()=>{G[y]=u,n(8,G)})}const pt=u=>{j(u.detail.keepSelection)},_t=u=>{j(u.ctrlKey),Pe()},gt=()=>{n(3,L=!L)};function mt(u){q[u?"unshift":"push"](()=>{U=u,n(7,U)})}function bt(){a=this.value,$.set(a)}const vt=u=>{j(u.ctrlKey)};function wt(u,y){q[u?"unshift":"push"](()=>{G[y]=u,n(8,G)})}const yt=u=>{j(u.detail.keepSelection)};function kt(u,y){q[u?"unshift":"push"](()=>{J[y]=u,n(9,J)})}const Et=u=>{j(u.detail.keepSelection)};return t.$$set=u=>{"noteId"in u&&n(2,_=u.noteId),"isReference"in u&&n(0,g=u.isReference),"Focus"in u&&n(1,j=u.Focus)},t.$$.update=()=>{t.$$.dirty[0]&671088640&&n(12,s=r==S),t.$$.dirty[0]&24&&n(4,i=L||i),t.$$.dirty[0]&1207959552&&n(11,ge=c===S),t.$$.dirty[0]&402653184&&n(13,o=p.includes(S)),t.$$.dirty[0]&64&&Be(),t.$$.dirty[0]&32&&Be()},[g,j,_,L,i,l,a,U,G,J,X,ge,s,o,v,k,$,O,ut,at,ft,Ke,Pe,d,Ue,He,me,S,p,r,c,ht,pt,_t,gt,mt,bt,vt,wt,yt,kt,Et]}class Ie extends Ee{constructor(e){super(),ke(this,e,Wt,Xt,_e,{instanceId:23,noteId:2,isReference:0,Expand:24,ExpandAll:25,Focus:1,getSortedGenespan:26},null,[-1,-1])}get instanceId(){return this.$$.ctx[23]}get Expand(){return this.$$.ctx[24]}get ExpandAll(){return this.$$.ctx[25]}get getSortedGenespan(){return this.$$.ctx[26]}}function zt(t){let e,n,s,i,o,l,a,p;return{c(){e=E("div"),n=E("button"),n.textContent="Download",s=R(),i=E("label"),i.textContent="Upload",o=R(),l=E("input"),b(n,"id","download_btn"),b(n,"class","file-button svelte-e1fw06"),b(i,"id","upload_btn"),b(i,"class","file-button svelte-e1fw06"),b(i,"for","file"),b(l,"id","file"),b(l,"type","file"),b(l,"accept",".tnp"),At(l,"display","none"),b(e,"id","MenuBar"),b(e,"class","svelte-e1fw06")},m(r,c){T(r,e,c),w(e,n),w(e,s),w(e,i),w(e,o),w(e,l),t[3](l),a||(p=[W(n,"click",function(){Oe(t[0])&&t[0].apply(this,arguments)}),W(l,"change",t[2])],a=!0)},p(r,[c]){t=r},i:H,o:H,d(r){r&&D(e),t[3](null),a=!1,z(p)}}}function Jt(t){return t.slice(0,-4)}function et(){document.title=Vt(document.title)}function Vt(t){return t.endsWith("*")?t.slice(0,-1):t}function qt(t,e,n){let s,i=async function(r){var c=K(ae.notes[0].children).length==0,h=s.files.length>0;if(h&&c){var f=Jt(s.files[0].name);document.title=f}for(var d=0;d<s.files.length;d++){var _=s.files[d];await o(_)}n(1,s.value="",s),setTimeout(et,100)},o=async function(r){var c=await r.text(),h=new re;h.loadFromJSON(JSON.parse(c)),h.Update();var f=h.notes[0];f.markup.set(r.name),ae.Merge(h)},{download:l=function(){var r=ae.getCopyForDownload(),c=JSON.stringify(r),h=new Blob([c],{type:"application/octet-binary"});a(h),et()}}=e,a=function(r){var c=document.createElement("a");c.setAttribute("href",URL.createObjectURL(r)),c.setAttribute("download",document.title+".tnp"),c.click()};function p(r){q[r?"unshift":"push"](()=>{s=r,n(1,s)})}return t.$$set=r=>{"download"in r&&n(0,l=r.download)},[l,s,i,p]}class Qt extends Ee{constructor(e){super(),ke(this,e,qt,zt,_e,{download:0})}}function Yt(t,e,n){const s=t.slice();return s[0]=e[n][0],s[1]=e[n][1],s}function Zt(t){let e,n,s,i,o,l,a;return{c(){e=E("tr"),n=E("td"),s=se(t[0]),i=R(),o=E("td"),l=se(t[1]),a=R(),b(n,"class","svelte-108dde0"),b(o,"class","svelte-108dde0")},m(p,r){T(p,e,r),w(e,n),w(n,s),w(e,i),w(e,o),w(o,l),w(e,a)},p:H,d(p){p&&D(e)}}}function xt(t){let e,n,s,i,o,l,a,p=[["Insert","Add a new note under the focused one"],["Delete","Delete selected notes"],["Up/Down Arrow","Move focus up/down"],["Enter","Make a note editable"],["Alt","Return an editable note to being uneditable"],["Shift+Up/Down","Swap Adjacent Siblings"],["Click on note","Focuses note"],["Ctrl+Focus Note","Keeps notes selected while focusing new one"],["Ctrl+C/X/V","Copy/Cut/Paste selected notes"],["Tab","Toggles whether focused note is expanded"],["Tab+Shift","Also expands children and grandchildren"]],r=[];for(let c=0;c<11;c+=1)r[c]=Zt(Yt(t,p,c));return{c(){e=E("div"),n=E("div"),n.innerHTML="<h2>Controls</h2>",s=R(),i=E("table"),o=E("thead"),o.innerHTML=`<tr><th class="svelte-108dde0">Command</th> 
            <th class="svelte-108dde0">Description</th></tr>`,l=R(),a=E("tbody");for(let c=0;c<11;c+=1)r[c].c();b(n,"class","title svelte-108dde0"),b(i,"class","svelte-108dde0"),b(e,"class","menu svelte-108dde0")},m(c,h){T(c,e,h),w(e,n),w(e,s),w(e,i),w(i,o),w(i,l),w(i,a);for(let f=0;f<11;f+=1)r[f]&&r[f].m(a,null)},p:H,i:H,o:H,d(c){c&&D(e),Dt(r,c)}}}class en extends Ee{constructor(e){super(),ke(this,e,null,xt,_e,{})}}function tt(t){let e,n,s;return n=new en({}),{c(){e=E("div"),ie(n.$$.fragment),b(e,"id","helpWrapper"),b(e,"class","svelte-wm15kg")},m(i,o){T(i,e,o),Y(n,e,null),s=!0},i(i){s||(C(n.$$.fragment,i),s=!0)},o(i){M(n.$$.fragment,i),s=!1},d(i){i&&D(e),Z(n)}}}function tn(t){let e,n,s,i,o,l,a=t[0]?"X":"?",p,r,c,h,f,d,_;i=new Qt({});let g=t[0]&&tt();return h=new Ie({props:{noteId:0}}),h.$on("CloseHelp",t[1]),{c(){e=E("main"),n=E("div"),s=E("span"),ie(i.$$.fragment),o=R(),l=E("button"),p=se(a),r=R(),g&&g.c(),c=R(),ie(h.$$.fragment),b(s,"id","Menubar"),b(s,"class","svelte-wm15kg"),b(l,"class","svelte-wm15kg"),F(l,"close-btn",t[0]),b(n,"id","Topbar"),b(n,"class","svelte-wm15kg"),b(e,"data-testid","my-element"),b(e,"class","svelte-wm15kg")},m(m,v){T(m,e,v),w(e,n),w(n,s),Y(i,s,null),w(n,o),w(n,l),w(l,p),w(e,r),g&&g.m(e,null),w(e,c),Y(h,e,null),f=!0,d||(_=W(l,"click",t[2]),d=!0)},p(m,[v]){(!f||v&1)&&a!==(a=m[0]?"X":"?")&&rt(p,a),(!f||v&1)&&F(l,"close-btn",m[0]),m[0]?g?v&1&&C(g,1):(g=tt(),g.c(),C(g,1),g.m(e,c)):g&&(de(),M(g,1,1,()=>{g=null}),he())},i(m){f||(C(i.$$.fragment,m),C(g),C(h.$$.fragment,m),f=!0)},o(m){M(i.$$.fragment,m),M(g),M(h.$$.fragment,m),f=!1},d(m){m&&D(e),Z(i),g&&g.d(),Z(h),d=!1,_()}}}function nn(t,e,n){let s=!1;return[s,function(){n(0,s=!1)},()=>n(0,s=!s)]}class sn extends Ee{constructor(e){super(),ke(this,e,nn,tn,_e,{})}}new sn({target:document.getElementById("app")});
