(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();function K(){}function Ze(t){return t()}function Be(){return Object.create(null)}function G(t){t.forEach(Ze)}function $e(t){return typeof t=="function"}function _e(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function yt(t){return Object.keys(t).length===0}function xe(t,...e){if(t==null)return K;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function B(t){let e;return xe(t,n=>e=n)(),e}function re(t,e,n){t.$$.on_destroy.push(xe(e,n))}function w(t,e){t.appendChild(e)}function M(t,e,n){t.insertBefore(e,n||null)}function F(t){t.parentNode&&t.parentNode.removeChild(t)}function kt(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function E(t){return document.createElement(t)}function ne(t){return document.createTextNode(t)}function R(){return ne(" ")}function we(){return ne("")}function X(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function et(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function b(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Et(t){return Array.from(t.childNodes)}function tt(t,e){e=""+e,t.data!==e&&(t.data=e)}function He(t,e){t.value=e??""}function It(t,e,n,s){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,s?"important":"")}function z(t,e,n){t.classList[n?"add":"remove"](e)}function Dt(t,e,{bubbles:n=!1,cancelable:s=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,s,e),r}let ue;function le(t){ue=t}function Le(){if(!ue)throw new Error("Function called outside component initialization");return ue}function Ne(t){Le().$$.on_mount.push(t)}function Nt(t){Le().$$.on_destroy.push(t)}function Ct(){const t=Le();return(e,n,{cancelable:s=!1}={})=>{const r=t.$$.callbacks[e];if(r){const o=Dt(e,n,{cancelable:s});return r.slice().forEach(l=>{l.call(t,o)}),!o.defaultPrevented}return!0}}const ee=[],J=[];let te=[];const Pe=[],nt=Promise.resolve();let Ae=!1;function st(){Ae||(Ae=!0,nt.then(rt))}function Ce(){return st(),nt}function Oe(t){te.push(t)}const Se=new Set;let Z=0;function rt(){if(Z!==0)return;const t=ue;do{try{for(;Z<ee.length;){const e=ee[Z];Z++,le(e),St(e.$$)}}catch(e){throw ee.length=0,Z=0,e}for(le(null),ee.length=0,Z=0;J.length;)J.pop()();for(let e=0;e<te.length;e+=1){const n=te[e];Se.has(n)||(Se.add(n),n())}te.length=0}while(ee.length);for(;Pe.length;)Pe.pop()();Ae=!1,Se.clear(),le(t)}function St(t){if(t.fragment!==null){t.update(),G(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Oe)}}function Ft(t){const e=[],n=[];te.forEach(s=>t.indexOf(s)===-1?e.push(s):n.push(s)),n.forEach(s=>s()),te=e}const ve=new Set;let V;function ae(){V={r:0,c:[],p:V}}function fe(){V.r||G(V.c),V=V.p}function N(t,e){t&&t.i&&(ve.delete(t),t.i(e))}function T(t,e,n,s){if(t&&t.o){if(ve.has(t))return;ve.add(t),V.c.push(()=>{ve.delete(t),s&&(n&&t.d(1),s())}),t.o(e)}else s&&s()}function Te(t,e){T(t,1,1,()=>{e.delete(t.key)})}function Me(t,e,n,s,r,o,l,a,h,i,c,_){let f=t.length,d=o.length,p=f;const g={};for(;p--;)g[t[p].key]=p;const m=[],v=new Map,A=new Map,D=[];for(p=d;p--;){const k=_(r,o,p),U=n(k);let $=l.get(U);$?s&&D.push(()=>$.p(k,e)):($=i(U,k),$.c()),v.set(U,m[p]=$),U in g&&A.set(U,Math.abs(p-g[U]))}const P=new Set,W=new Set;function j(k){N(k,1),k.m(a,c),l.set(k.key,k),c=k.first,d--}for(;f&&d;){const k=m[d-1],U=t[f-1],$=k.key,L=U.key;k===U?(c=k.first,f--,d--):v.has(L)?!l.has($)||P.has($)?j(k):W.has(L)?f--:A.get($)>A.get(L)?(W.add($),j(k)):(P.add(L),f--):(h(U,l),f--)}for(;f--;){const k=t[f];v.has(k.key)||h(k,l)}for(;d;)j(m[d-1]);return G(D),m}function se(t){t&&t.c()}function Q(t,e,n,s){const{fragment:r,after_update:o}=t.$$;r&&r.m(e,n),s||Oe(()=>{const l=t.$$.on_mount.map(Ze).filter($e);t.$$.on_destroy?t.$$.on_destroy.push(...l):G(l),t.$$.on_mount=[]}),o.forEach(Oe)}function Y(t,e){const n=t.$$;n.fragment!==null&&(Ft(n.after_update),G(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function At(t,e){t.$$.dirty[0]===-1&&(ee.push(t),st(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ye(t,e,n,s,r,o,l,a=[-1]){const h=ue;le(t);const i=t.$$={fragment:null,ctx:[],props:o,update:K,not_equal:r,bound:Be(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(h?h.$$.context:[])),callbacks:Be(),dirty:a,skip_bound:!1,root:e.target||h.$$.root};l&&l(i.root);let c=!1;if(i.ctx=n?n(t,e.props||{},(_,f,...d)=>{const p=d.length?d[0]:f;return i.ctx&&r(i.ctx[_],i.ctx[_]=p)&&(!i.skip_bound&&i.bound[_]&&i.bound[_](p),c&&At(t,_)),f}):[],i.update(),c=!0,G(i.before_update),i.fragment=s?s(i.ctx):!1,e.target){if(e.hydrate){const _=Et(e.target);i.fragment&&i.fragment.l(_),_.forEach(F)}else i.fragment&&i.fragment.c();e.intro&&N(t.$$.fragment),Q(t,e.target,e.anchor,e.customElement),rt()}le(h)}class ke{$destroy(){Y(this,1),this.$destroy=K}$on(e,n){if(!$e(n))return K;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const r=s.indexOf(n);r!==-1&&s.splice(r,1)}}$set(e){this.$$set&&!yt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const x=[];function de(t,e=K){let n;const s=new Set;function r(a){if(_e(t,a)&&(t=a,n)){const h=!x.length;for(const i of s)i[1](),x.push(i,t);if(h){for(let i=0;i<x.length;i+=2)x[i][0](x[i+1]);x.length=0}}}function o(a){r(a(t))}function l(a,h=K){const i=[a,h];return s.add(i),s.size===1&&(n=e(r)||K),a(t),()=>{s.delete(i),s.size===0&&n&&(n(),n=null)}}return{set:r,update:o,subscribe:l}}class me{constructor(e,n="",s=[]){this.id=e,this.markup=de(n),this.children=de(s)}add(e){B(this.children).includes(e.id)||this.children.set([...B(this.children),e.id])}}const qe=2;class he{constructor(){var e=new me(0);this.notes={0:e},this.uID=1,this.version=qe}reset(){var e=new me(0);this.notes={0:e},this.uID=1}loadFromJSON(e){var n;for(n in e.notes){var s=e.notes[n],r=new me(n);r.children.set(s.children),r.markup.set(s.markup),this.notes[n]=r}}getCopyForDownload(){let e=(function(s){let r=(function(o,l){l[o.id]||(l[o.id]={id:o.id,markup:B(o.markup),children:B(o.children)},B(o.children).forEach((function(a){r(this.notes[a],l)}).bind(this)))}).bind(this);return r(this.notes[0],s),s}).bind(this),n={version:this.version,notes:{}};return e(n.notes),n}addNewChild({parent:e}){var n=this.getNewNote();return e.add(n),n}getNoteByID(e){return this.notes[e]}getNextUID(){for(;this.uID in this.notes;)this.uID++;return this.uID}swapPlaces(e,n,s){for(var r=B(e.children),o=0;o<r.length;o++)if([n.id,s.id].includes(r[o])){[r[o],r[o+1]]=[r[o+1],r[o]];return}}getNewNote(){var e=this.getNextUID(),n=new me(e);return this.notes[e]=n,n}getRoot(){var e=this.notes[0];if(!e)throw new Error("no root found");return e}Merge(e){var n=e.notes[0],s=0,r=(function(){return s+=1,!(s in this.notes)&&!(s in e.notes)?s:r()}).bind(this),o;for(var o in e.notes){var l=r();e.editNoteId(+o,l)}this.notes={...this.notes,...e.notes};var a=B(this.getRoot().children).length==0;return a?B(n.children).forEach(h=>{this.getRoot().add(this.notes[h])}):this.getRoot().add(n),n}editNoteId(e,n){var s=this.notes[e];s.id=n,delete this.notes[e],this.notes[n]=s;var r;for(r in this.notes){var s=this.notes[r];s.children.set(B(s.children).map(l=>l==e?n:l)),s.markup.set(String(B(s.markup)).replace(he.GetNoteLinkOpeningTag(e),he.GetNoteLinkOpeningTag(n)))}}Update(){for(this.version||(this.version=1);this.version<qe;)this.UpgradeByOneVersion()}UpgradeByOneVersion(){switch(this.version){}this.version++}static GetNoteLinkOpeningTag(e){return`<a id="${e}" href="#0">`}swapNotes(e,n,s){var r=B(e.children).map(function(o){return o==n.id?s.id:o==s.id?n.id:o});e.children.set(r)}}let ce=new he,Ot=0;const Tt=function(){return Ot++},ie=de(null),be=de(null),oe=de([]),Fe={copiedInstances:[]},Mt={MIN_TEXTBOX_HEIGHT:50};function Ge(t,e,n){const s=t.slice();return s[2]=e[n],s[47]=e,s[48]=n,s}function We(t,e,n){const s=t.slice();return s[2]=e[n],s[49]=e,s[48]=n,s}function Xe(t,e,n){const s=t.slice();return s[2]=e[n],s[50]=e,s[48]=n,s}function $t(t){let e,n=[],s=new Map,r,o,l,a=t[5];const h=i=>i[2];for(let i=0;i<a.length;i+=1){let c=Xe(t,a,i),_=h(c);s.set(_,n[i]=je(_,c))}return{c(){e=E("div");for(let i=0;i<n.length;i+=1)n[i].c();b(e,"id","notepad"),b(e,"class","svelte-9z2dqz"),z(e,"isFocused",t[11])},m(i,c){M(i,e,c);for(let _=0;_<n.length;_+=1)n[_]&&n[_].m(e,null);r=!0,o||(l=X(e,"click",et(t[31])),o=!0)},p(i,c){c[0]&786722&&(a=i[5],ae(),n=Me(n,c,h,1,i,a,s,e,Te,je,null,Xe),fe()),(!r||c[0]&2048)&&z(e,"isFocused",i[11])},i(i){if(!r){for(let c=0;c<a.length;c+=1)N(n[c]);r=!0}},o(i){for(let c=0;c<n.length;c+=1)T(n[c]);r=!1},d(i){i&&F(e);for(let c=0;c<n.length;c+=1)n[c].d();o=!1,l()}}}function je(t,e){let n,s,r=e[48],o;const l=()=>e[29](s,r),a=()=>e[29](null,r);let h={noteId:e[2]};return s=new Ee({props:h}),l(),s.$on("SwapChildren",e[18]),s.$on("DeleteChild",e[19]),s.$on("Focus",e[30]),{key:t,first:null,c(){n=we(),se(s.$$.fragment),this.first=n},m(i,c){M(i,n,c),Q(s,i,c),o=!0},p(i,c){e=i,r!==e[48]&&(a(),r=e[48],l());const _={};c[0]&32&&(_.noteId=e[2]),s.$set(_)},i(i){o||(N(s.$$.fragment,i),o=!0)},o(i){T(s.$$.fragment,i),o=!1},d(i){i&&F(n),a(),Y(s,i)}}}function Lt(t){let e,n,s=t[3]?"v":">",r,o,l,a,h,i,c,_;function f(m,v){return m[12]?zt:Ut}let d=f(t),p=d(t),g=t[4]&&Je(t);return{c(){e=E("div"),n=E("button"),r=ne(s),o=R(),l=E("span"),p.c(),a=R(),g&&g.c(),h=we(),b(n,"id","toggleButton"),b(n,"class","svelte-9z2dqz"),z(n,"boldText",t[5].length>0),b(l,"id","text"),b(l,"class","svelte-9z2dqz"),b(e,"id","topRow"),b(e,"class","svelte-9z2dqz")},m(m,v){M(m,e,v),w(e,n),w(n,r),w(e,o),w(e,l),p.m(l,null),M(m,a,v),g&&g.m(m,v),M(m,h,v),i=!0,c||(_=[X(n,"click",t[32]),X(l,"click",et(t[35]))],c=!0)},p(m,v){(!i||v[0]&8)&&s!==(s=m[3]?"v":">")&&tt(r,s),(!i||v[0]&32)&&z(n,"boldText",m[5].length>0),d===(d=f(m))&&p?p.p(m,v):(p.d(1),p=d(m),p&&(p.c(),p.m(l,null))),m[4]?g?(g.p(m,v),v[0]&16&&N(g,1)):(g=Je(m),g.c(),N(g,1),g.m(h.parentNode,h)):g&&(ae(),T(g,1,1,()=>{g=null}),fe())},i(m){i||(N(g),i=!0)},o(m){T(g),i=!1},d(m){m&&F(e),p.d(),m&&F(a),g&&g.d(m),m&&F(h),c=!1,G(_)}}}function Ut(t){let e;return{c(){e=E("span")},m(n,s){M(n,e,s),e.innerHTML=t[6]},p(n,s){s[0]&64&&(e.innerHTML=n[6])},d(n){n&&F(e)}}}function zt(t){let e,n,s;return{c(){e=E("textarea"),b(e,"class","svelte-9z2dqz")},m(r,o){M(r,e,o),t[33](e),He(e,t[6]),n||(s=[X(e,"input",t[34]),X(e,"input",t[20])],n=!0)},p(r,o){o[0]&64&&He(e,r[6])},d(r){r&&F(e),t[33](null),n=!1,G(s)}}}function Je(t){let e,n=[],s=new Map,r,o=[],l=new Map,a,h=t[5];const i=f=>f[2];for(let f=0;f<h.length;f+=1){let d=We(t,h,f),p=i(d);s.set(p,n[f]=Ve(p,d))}let c=t[10];const _=f=>f[2];for(let f=0;f<c.length;f+=1){let d=Ge(t,c,f),p=_(d);l.set(p,o[f]=Qe(p,d))}return{c(){e=E("div");for(let f=0;f<n.length;f+=1)n[f].c();r=R();for(let f=0;f<o.length;f+=1)o[f].c();b(e,"id","childContainer"),b(e,"class","svelte-9z2dqz"),z(e,"hidden",!t[3])},m(f,d){M(f,e,d);for(let p=0;p<n.length;p+=1)n[p]&&n[p].m(e,null);w(e,r);for(let p=0;p<o.length;p+=1)o[p]&&o[p].m(e,null);a=!0},p(f,d){d[0]&786722&&(h=f[5],ae(),n=Me(n,d,i,1,f,h,s,e,Te,Ve,r,We),fe()),d[0]&525826&&(c=f[10],ae(),o=Me(o,d,_,1,f,c,l,e,Te,Qe,null,Ge),fe()),(!a||d[0]&8)&&z(e,"hidden",!f[3])},i(f){if(!a){for(let d=0;d<h.length;d+=1)N(n[d]);for(let d=0;d<c.length;d+=1)N(o[d]);a=!0}},o(f){for(let d=0;d<n.length;d+=1)T(n[d]);for(let d=0;d<o.length;d+=1)T(o[d]);a=!1},d(f){f&&F(e);for(let d=0;d<n.length;d+=1)n[d].d();for(let d=0;d<o.length;d+=1)o[d].d()}}}function Ve(t,e){let n,s,r=e[48],o;const l=()=>e[36](s,r),a=()=>e[36](null,r);let h={noteId:e[2]};return s=new Ee({props:h}),l(),s.$on("SwapChildren",e[18]),s.$on("DeleteChild",e[19]),s.$on("Focus",e[37]),{key:t,first:null,c(){n=we(),se(s.$$.fragment),this.first=n},m(i,c){M(i,n,c),Q(s,i,c),o=!0},p(i,c){e=i,r!==e[48]&&(a(),r=e[48],l());const _={};c[0]&32&&(_.noteId=e[2]),s.$set(_)},i(i){o||(N(s.$$.fragment,i),o=!0)},o(i){T(s.$$.fragment,i),o=!1},d(i){i&&F(n),a(),Y(s,i)}}}function Qe(t,e){let n,s,r=e[48],o;const l=()=>e[38](s,r),a=()=>e[38](null,r);let h={noteId:e[2],isReference:!0};return s=new Ee({props:h}),l(),s.$on("DeleteChild",e[19]),s.$on("Focus",e[39]),{key:t,first:null,c(){n=we(),se(s.$$.fragment),this.first=n},m(i,c){M(i,n,c),Q(s,i,c),o=!0},p(i,c){e=i,r!==e[48]&&(a(),r=e[48],l());const _={};c[0]&1024&&(_.noteId=e[2]),s.$set(_)},i(i){o||(N(s.$$.fragment,i),o=!0)},o(i){T(s.$$.fragment,i),o=!1},d(i){i&&F(n),a(),Y(s,i)}}}function Kt(t){let e,n,s,r=t[15]&&$t(t),o=!t[15]&&Lt(t);return{c(){e=E("div"),r&&r.c(),n=R(),o&&o.c(),b(e,"id","note "+t[14].id),b(e,"class","noteWrapper svelte-9z2dqz"),b(e,"style",t[15]?"height: 100%;":""),z(e,"selected",t[13]),z(e,"isFocused",t[11]),z(e,"referenceContainer",t[0])},m(l,a){M(l,e,a),r&&r.m(e,null),w(e,n),o&&o.m(e,null),s=!0},p(l,a){l[15]&&r.p(l,a),l[15]||o.p(l,a),(!s||a[0]&8192)&&z(e,"selected",l[13]),(!s||a[0]&2048)&&z(e,"isFocused",l[11]),(!s||a[0]&1)&&z(e,"referenceContainer",l[0])},i(l){s||(N(r),N(o),s=!0)},o(l){T(r),T(o),s=!1},d(l){l&&F(e),r&&r.d(),o&&o.d()}}}function Rt(t){return t.endsWith("*")?t.slice(0,-1):t}function Bt(t,e,n){let s,r,o,l,a,h,i,c;re(t,oe,u=>n(26,h=u)),re(t,be,u=>n(27,i=u)),re(t,ie,u=>n(28,c=u));const _=Ct(),f=function(){_("DeleteChild",{target:A,isFocused:pe})},d=Tt();let{noteId:p}=e,{isReference:g=!1}=e,v=ce.notes[p];const A={note:v,noteId:p,instanceId:d,Delete:f};let D,P=[],W=[],j=[];const k=p==0;let U=v.markup;re(t,U,u=>n(6,a=u));let $=v.children;re(t,$,u=>n(5,l=u));let L=!1;const it=function(){n(3,L=!0)},Ue=async function(u){if(!(u<=0)){await Ce();var y=[...P,...W];y.forEach(O=>{O.Expand(),O.ExpandAll(u-1)})}};let pe=!1,{Focus:q=function(u=!1){if(c!=A&&be.set(null),ie.set(A),k){u||oe.set([]);return}else Ie(A,u)}}=e;A.Focus=q;let Ie=function(u,y){let O=y?[...h,u]:[u];oe.set(O)},ot=function(u){let{child_to_swap:y,moveUp:O}=u.detail;var C=l.indexOf(y),I=C+(O?-1:1),S=I>=0&&I<l.length;if(S){let H=[...l];[H[C],H[I]]=[H[I],H[C]],$.set(H)}},lt=function(u){let{target:y,isFocused:O}=u.detail;if(O){var C=ge();let S=C.indexOf(y);if(S==1)q();else{var I=C[S-1];ie.set(I),oe.set([I])}}n(10,j=j.filter(S=>S!=y.instanceId)),$.set([...l.filter(S=>S!=y.note.id)])};const ge=function(){var u=[A];if(L||k){var y=[...P,...W];y.forEach(O=>{if(O!=null){var C=[];C=O.getSortedGenespan(),u=u.concat(C)}})}return u};let ze=function(u){if(pe){if(u.stopImmediatePropagation(),!s)switch(u.key){case"ArrowUp":u.shiftKey&&_("SwapChildren",{child_to_swap:v.id,moveUp:!0});break;case"ArrowDown":u.shiftKey&&_("SwapChildren",{child_to_swap:v.id,moveUp:!1});break;case"ArrowLeft":_("Focus",{keepSelection:u.ctrlKey});break;case"Insert":u.preventDefault();var y=ce.addNewChild({parent:v});n(3,L=!0),u.ctrlKey||Ce().then(()=>{ge().forEach(S=>{S.note==y&&(ie.set(S),oe.set([S]))})});break;case"Tab":u.preventDefault(),n(3,L=!L),u.shiftKey&&Ue(2);break;case"Enter":k||(u.preventDefault(),be.set(A),Ce().then(()=>{D.focus(),Ie(A,!1),Ke()}));break;case"i":if(u.ctrlKey)debugger;break;case"c":u.ctrlKey&&(Fe.copiedInstances=[...h]);break;case"x":u.ctrlKey&&(Fe.copiedInstances=[...h],h.forEach(I=>I.Delete()));break;case"v":u.ctrlKey&&(Fe.copiedInstances.forEach(function(I){var S=l.includes(I.noteId);S||v.add(I.note)}),l.length>0&&n(3,L=!0));break;case"Alt":u.preventDefault();break}if(s)switch(u.key){case"Enter":break;case"Alt":u.preventDefault(),be.set(null);break;case"Tab":u.preventDefault();var O=D.selectionStart,C=D.selectionEnd;n(7,D.value=D.value.substring(0,O)+"	"+D.value.substring(C),D),n(7,D.selectionStart=n(7,D.selectionEnd=O+1,D),D)}}};Ne(()=>{window.addEventListener("keydown",ze)}),Nt(()=>{window.removeEventListener("keydown",ze)});function Ke(){var u=Math.max(Mt.MIN_TEXTBOX_HEIGHT,D.scrollHeight)+"px";n(7,D.style.height=u,D)}k&&(Ne(q),window.addEventListener("keydown",function(y){let O=function(C){for(var I=ge(),S,H=0;H<I.length;H++){var vt=I[H];if(vt==c){S=H;break}}var De=S+(C?-1:1),wt=De>=0&&De<I.length;return wt?I[De]:null};if((y.key=="ArrowUp"||y.key=="ArrowDown")&&i==null&&(y.preventDefault(),!y.shiftKey)){let C=y.key=="ArrowUp",I=O(C);I!=null&&(ie.set(I),Ie(I,y.ctrlKey))}y.key=="Delete"&&h.forEach(C=>{C.Delete()})}));var Re=function(){document.title.endsWith("*")||(document.title=document.title+"*")};k&&Ne(()=>{document.title=Rt(document.title)});function ct(u,y){J[u?"unshift":"push"](()=>{P[y]=u,n(8,P)})}const ut=u=>{q(u.detail.keepSelection)},at=u=>{q(u.ctrlKey)},ft=()=>{n(3,L=!L)};function dt(u){J[u?"unshift":"push"](()=>{D=u,n(7,D)})}function ht(){a=this.value,U.set(a)}const _t=u=>{q(u.ctrlKey)};function pt(u,y){J[u?"unshift":"push"](()=>{P[y]=u,n(8,P)})}const gt=u=>{q(u.detail.keepSelection)};function mt(u,y){J[u?"unshift":"push"](()=>{W[y]=u,n(9,W)})}const bt=u=>{q(u.detail.keepSelection)};return t.$$set=u=>{"noteId"in u&&n(2,p=u.noteId),"isReference"in u&&n(0,g=u.isReference),"Focus"in u&&n(1,q=u.Focus)},t.$$.update=()=>{t.$$.dirty[0]&167772160&&n(12,s=i==A),t.$$.dirty[0]&24&&n(4,r=L||r),t.$$.dirty[0]&301989888&&n(11,pe=c===A),t.$$.dirty[0]&100663296&&n(13,o=h.includes(A)),t.$$.dirty[0]&64&&Re(),t.$$.dirty[0]&32&&Re()},[g,q,p,L,r,l,a,D,P,W,j,pe,s,o,v,k,U,$,ot,lt,Ke,d,it,Ue,ge,A,h,i,c,ct,ut,at,ft,dt,ht,_t,pt,gt,mt,bt]}class Ee extends ke{constructor(e){super(),ye(this,e,Bt,Kt,_e,{instanceId:21,noteId:2,isReference:0,Expand:22,ExpandAll:23,Focus:1,getSortedGenespan:24},null,[-1,-1])}get instanceId(){return this.$$.ctx[21]}get Expand(){return this.$$.ctx[22]}get ExpandAll(){return this.$$.ctx[23]}get getSortedGenespan(){return this.$$.ctx[24]}}function Ht(t){let e,n,s,r,o,l,a,h;return{c(){e=E("div"),n=E("button"),n.textContent="Download",s=R(),r=E("label"),r.textContent="Upload",o=R(),l=E("input"),b(n,"id","download_btn"),b(n,"class","file-button svelte-e1fw06"),b(r,"id","upload_btn"),b(r,"class","file-button svelte-e1fw06"),b(r,"for","file"),b(l,"id","file"),b(l,"type","file"),b(l,"accept",".tnp"),It(l,"display","none"),b(e,"id","MenuBar"),b(e,"class","svelte-e1fw06")},m(i,c){M(i,e,c),w(e,n),w(e,s),w(e,r),w(e,o),w(e,l),t[3](l),a||(h=[X(n,"click",function(){$e(t[0])&&t[0].apply(this,arguments)}),X(l,"change",t[2])],a=!0)},p(i,[c]){t=i},i:K,o:K,d(i){i&&F(e),t[3](null),a=!1,G(h)}}}function Pt(t){return t.slice(0,-4)}function qt(t){return t.endsWith("*")?t.slice(0,-1):t}function Gt(t,e,n){let s,r=async function(i){var c=B(ce.notes[0].children).length==0,_=s.files.length>0;if(_&&c){var f=Pt(s.files[0].name);document.title=f}for(var d=0;d<s.files.length;d++){var p=s.files[d];await o(p)}n(1,s.value="",s)},o=async function(i){var c=await i.text(),_=new he;_.loadFromJSON(JSON.parse(c)),_.Update();var f=_.notes[0];f.markup.set(i.name),ce.Merge(_)},{download:l=function(){var i=ce.getCopyForDownload(),c=JSON.stringify(i),_=new Blob([c],{type:"application/octet-binary"});a(_),document.title=qt(document.title)}}=e,a=function(i){var c=document.createElement("a");c.setAttribute("href",URL.createObjectURL(i)),c.setAttribute("download",document.title+".tnp"),c.click()};window.addEventListener("beforeunload",function(i){document.title.endsWith("*")&&i.preventDefault()});function h(i){J[i?"unshift":"push"](()=>{s=i,n(1,s)})}return t.$$set=i=>{"download"in i&&n(0,l=i.download)},[l,s,r,h]}class Wt extends ke{constructor(e){super(),ye(this,e,Gt,Ht,_e,{download:0})}}function Xt(t,e,n){const s=t.slice();return s[0]=e[n][0],s[1]=e[n][1],s}function jt(t){let e,n,s,r,o,l,a;return{c(){e=E("tr"),n=E("td"),s=ne(t[0]),r=R(),o=E("td"),l=ne(t[1]),a=R(),b(n,"class","svelte-108dde0"),b(o,"class","svelte-108dde0")},m(h,i){M(h,e,i),w(e,n),w(n,s),w(e,r),w(e,o),w(o,l),w(e,a)},p:K,d(h){h&&F(e)}}}function Jt(t){let e,n,s,r,o,l,a,h=[["Insert","Add a new note under the focused one"],["Delete","Delete selected notes"],["Up/Down Arrow","Move focus up/down"],["Shift+Up/Down","Swap Adjacent Siblings"],["Click on note","Focuses note"],["Ctrl+Focus Note","Keeps notes selected while focusing new one"],["Ctrl+C/X/V","Copy/Cut/Paste selected notes"],["Tab","Toggles whether focused note is expanded"],["Tab+Shift","Also expands children and grandchildren"]],i=[];for(let c=0;c<9;c+=1)i[c]=jt(Xt(t,h,c));return{c(){e=E("div"),n=E("div"),n.innerHTML="<h2>Controls</h2>",s=R(),r=E("table"),o=E("thead"),o.innerHTML=`<tr><th class="svelte-108dde0">Command</th> 
            <th class="svelte-108dde0">Description</th></tr>`,l=R(),a=E("tbody");for(let c=0;c<9;c+=1)i[c].c();b(n,"class","title svelte-108dde0"),b(r,"class","svelte-108dde0"),b(e,"class","menu svelte-108dde0")},m(c,_){M(c,e,_),w(e,n),w(e,s),w(e,r),w(r,o),w(r,l),w(r,a);for(let f=0;f<9;f+=1)i[f]&&i[f].m(a,null)},p:K,i:K,o:K,d(c){c&&F(e),kt(i,c)}}}class Vt extends ke{constructor(e){super(),ye(this,e,null,Jt,_e,{})}}function Ye(t){let e,n,s;return n=new Vt({}),{c(){e=E("div"),se(n.$$.fragment),b(e,"id","helpWrapper"),b(e,"class","svelte-1o42fnl")},m(r,o){M(r,e,o),Q(n,e,null),s=!0},i(r){s||(N(n.$$.fragment,r),s=!0)},o(r){T(n.$$.fragment,r),s=!1},d(r){r&&F(e),Y(n)}}}function Qt(t){let e,n,s,r,o,l,a=t[0]?"X":"?",h,i,c,_,f,d,p;r=new Wt({});let g=t[0]&&Ye();return _=new Ee({props:{noteId:0}}),{c(){e=E("main"),n=E("div"),s=E("span"),se(r.$$.fragment),o=R(),l=E("button"),h=ne(a),i=R(),g&&g.c(),c=R(),se(_.$$.fragment),b(s,"id","Menubar"),b(s,"class","svelte-1o42fnl"),b(l,"class","svelte-1o42fnl"),z(l,"close-btn",t[0]),b(n,"id","Topbar"),b(n,"class","svelte-1o42fnl"),b(e,"data-testid","my-element"),b(e,"class","svelte-1o42fnl")},m(m,v){M(m,e,v),w(e,n),w(n,s),Q(r,s,null),w(n,o),w(n,l),w(l,h),w(e,i),g&&g.m(e,null),w(e,c),Q(_,e,null),f=!0,d||(p=X(l,"click",t[1]),d=!0)},p(m,[v]){(!f||v&1)&&a!==(a=m[0]?"X":"?")&&tt(h,a),(!f||v&1)&&z(l,"close-btn",m[0]),m[0]?g?v&1&&N(g,1):(g=Ye(),g.c(),N(g,1),g.m(e,c)):g&&(ae(),T(g,1,1,()=>{g=null}),fe())},i(m){f||(N(r.$$.fragment,m),N(g),N(_.$$.fragment,m),f=!0)},o(m){T(r.$$.fragment,m),T(g),T(_.$$.fragment,m),f=!1},d(m){m&&F(e),Y(r),g&&g.d(),Y(_),d=!1,p()}}}function Yt(t,e,n){let s=!1;return[s,()=>n(0,s=!s)]}class Zt extends ke{constructor(e){super(),ye(this,e,Yt,Qt,_e,{})}}new Zt({target:document.getElementById("app")});
