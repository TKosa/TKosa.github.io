(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();function H(){}function et(t){return t()}function Be(){return Object.create(null)}function G(t){t.forEach(et)}function $e(t){return typeof t=="function"}function pe(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Et(t){return Object.keys(t).length===0}function tt(t,...e){if(t==null)return H;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function R(t){let e;return tt(t,n=>e=n)(),e}function re(t,e,n){t.$$.on_destroy.push(tt(e,n))}function w(t,e){t.appendChild(e)}function M(t,e,n){t.insertBefore(e,n||null)}function A(t){t.parentNode&&t.parentNode.removeChild(t)}function It(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function E(t){return document.createElement(t)}function ne(t){return document.createTextNode(t)}function K(){return ne(" ")}function we(){return ne("")}function j(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function nt(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function b(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Ct(t){return Array.from(t.childNodes)}function st(t,e){e=""+e,t.data!==e&&(t.data=e)}function Pe(t,e){t.value=e??""}function Nt(t,e,n,s){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,s?"important":"")}function z(t,e,n){t.classList[n?"add":"remove"](e)}function Dt(t,e,{bubbles:n=!1,cancelable:s=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,s,e),r}let ue;function le(t){ue=t}function Le(){if(!ue)throw new Error("Function called outside component initialization");return ue}function Ne(t){Le().$$.on_mount.push(t)}function St(t){Le().$$.on_destroy.push(t)}function At(){const t=Le();return(e,n,{cancelable:s=!1}={})=>{const r=t.$$.callbacks[e];if(r){const o=Dt(e,n,{cancelable:s});return r.slice().forEach(l=>{l.call(t,o)}),!o.defaultPrevented}return!0}}const ee=[],J=[];let te=[];const qe=[],rt=Promise.resolve();let Fe=!1;function it(){Fe||(Fe=!0,rt.then(ot))}function De(){return it(),rt}function Te(t){te.push(t)}const Se=new Set;let Z=0;function ot(){if(Z!==0)return;const t=ue;do{try{for(;Z<ee.length;){const e=ee[Z];Z++,le(e),Ft(e.$$)}}catch(e){throw ee.length=0,Z=0,e}for(le(null),ee.length=0,Z=0;J.length;)J.pop()();for(let e=0;e<te.length;e+=1){const n=te[e];Se.has(n)||(Se.add(n),n())}te.length=0}while(ee.length);for(;qe.length;)qe.pop()();Fe=!1,Se.clear(),le(t)}function Ft(t){if(t.fragment!==null){t.update(),G(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Te)}}function Tt(t){const e=[],n=[];te.forEach(s=>t.indexOf(s)===-1?e.push(s):n.push(s)),n.forEach(s=>s()),te=e}const ve=new Set;let V;function ae(){V={r:0,c:[],p:V}}function fe(){V.r||G(V.c),V=V.p}function N(t,e){t&&t.i&&(ve.delete(t),t.i(e))}function O(t,e,n,s){if(t&&t.o){if(ve.has(t))return;ve.add(t),V.c.push(()=>{ve.delete(t),s&&(n&&t.d(1),s())}),t.o(e)}else s&&s()}function Oe(t,e){O(t,1,1,()=>{e.delete(t.key)})}function Me(t,e,n,s,r,o,l,a,p,i,c,h){let f=t.length,d=o.length,_=f;const g={};for(;_--;)g[t[_].key]=_;const m=[],v=new Map,F=new Map,C=[];for(_=d;_--;){const k=h(r,o,_),U=n(k);let $=l.get(U);$?s&&C.push(()=>$.p(k,e)):($=i(U,k),$.c()),v.set(U,m[_]=$),U in g&&F.set(U,Math.abs(_-g[U]))}const P=new Set,X=new Set;function W(k){N(k,1),k.m(a,c),l.set(k.key,k),c=k.first,d--}for(;f&&d;){const k=m[d-1],U=t[f-1],$=k.key,L=U.key;k===U?(c=k.first,f--,d--):v.has(L)?!l.has($)||P.has($)?W(k):X.has(L)?f--:F.get($)>F.get(L)?(X.add($),W(k)):(P.add(L),f--):(p(U,l),f--)}for(;f--;){const k=t[f];v.has(k.key)||p(k,l)}for(;d;)W(m[d-1]);return G(C),m}function se(t){t&&t.c()}function Q(t,e,n,s){const{fragment:r,after_update:o}=t.$$;r&&r.m(e,n),s||Te(()=>{const l=t.$$.on_mount.map(et).filter($e);t.$$.on_destroy?t.$$.on_destroy.push(...l):G(l),t.$$.on_mount=[]}),o.forEach(Te)}function Y(t,e){const n=t.$$;n.fragment!==null&&(Tt(n.after_update),G(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Ot(t,e){t.$$.dirty[0]===-1&&(ee.push(t),it(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ye(t,e,n,s,r,o,l,a=[-1]){const p=ue;le(t);const i=t.$$={fragment:null,ctx:[],props:o,update:H,not_equal:r,bound:Be(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(p?p.$$.context:[])),callbacks:Be(),dirty:a,skip_bound:!1,root:e.target||p.$$.root};l&&l(i.root);let c=!1;if(i.ctx=n?n(t,e.props||{},(h,f,...d)=>{const _=d.length?d[0]:f;return i.ctx&&r(i.ctx[h],i.ctx[h]=_)&&(!i.skip_bound&&i.bound[h]&&i.bound[h](_),c&&Ot(t,h)),f}):[],i.update(),c=!0,G(i.before_update),i.fragment=s?s(i.ctx):!1,e.target){if(e.hydrate){const h=Ct(e.target);i.fragment&&i.fragment.l(h),h.forEach(A)}else i.fragment&&i.fragment.c();e.intro&&N(t.$$.fragment),Q(t,e.target,e.anchor,e.customElement),ot()}le(p)}class ke{$destroy(){Y(this,1),this.$destroy=H}$on(e,n){if(!$e(n))return H;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const r=s.indexOf(n);r!==-1&&s.splice(r,1)}}$set(e){this.$$set&&!Et(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const x=[];function de(t,e=H){let n;const s=new Set;function r(a){if(pe(t,a)&&(t=a,n)){const p=!x.length;for(const i of s)i[1](),x.push(i,t);if(p){for(let i=0;i<x.length;i+=2)x[i][0](x[i+1]);x.length=0}}}function o(a){r(a(t))}function l(a,p=H){const i=[a,p];return s.add(i),s.size===1&&(n=e(r)||H),a(t),()=>{s.delete(i),s.size===0&&n&&(n(),n=null)}}return{set:r,update:o,subscribe:l}}class me{constructor(e,n="",s=[]){this.id=e,this.markup=de(n),this.children=de(s)}add(e){R(this.children).includes(e.id)||this.children.set([...R(this.children),e.id])}}const Ge=2;class he{constructor(){var e=new me(0);this.notes={0:e},this.uID=1,this.version=Ge}reset(){var e=new me(0);this.notes={0:e},this.uID=1}loadFromJSON(e){var n;for(n in e.notes){var s=e.notes[n],r=new me(n);r.children.set(s.children),r.markup.set(s.markup),this.notes[n]=r}}getCopyForDownload(){let e=(function(s){let r=(function(o,l){l[o.id]||(l[o.id]={id:o.id,markup:R(o.markup),children:R(o.children)},R(o.children).forEach((function(a){r(this.notes[a],l)}).bind(this)))}).bind(this);return r(this.notes[0],s),s}).bind(this),n={version:this.version,notes:{}};return e(n.notes),n}addNewChild({parent:e}){var n=this.getNewNote();return e.add(n),n}getNoteByID(e){return this.notes[e]}getNextUID(){for(;this.uID in this.notes;)this.uID++;return this.uID}swapPlaces(e,n,s){for(var r=R(e.children),o=0;o<r.length;o++)if([n.id,s.id].includes(r[o])){[r[o],r[o+1]]=[r[o+1],r[o]];return}}getNewNote(){var e=this.getNextUID(),n=new me(e);return this.notes[e]=n,n}getRoot(){var e=this.notes[0];if(!e)throw new Error("no root found");return e}Merge(e){var n=e.notes[0],s=0,r=(function(){return s+=1,!(s in this.notes)&&!(s in e.notes)?s:r()}).bind(this),o;for(var o in e.notes){var l=r();e.editNoteId(+o,l)}this.notes={...this.notes,...e.notes};var a=R(this.getRoot().children).length==0;return a?R(n.children).forEach(p=>{this.getRoot().add(this.notes[p])}):this.getRoot().add(n),n}editNoteId(e,n){var s=this.notes[e];s.id=n,delete this.notes[e],this.notes[n]=s;var r;for(r in this.notes){var s=this.notes[r];s.children.set(R(s.children).map(l=>l==e?n:l)),s.markup.set(String(R(s.markup)).replace(he.GetNoteLinkOpeningTag(e),he.GetNoteLinkOpeningTag(n)))}}Update(){for(this.version||(this.version=1);this.version<Ge;)this.UpgradeByOneVersion()}UpgradeByOneVersion(){switch(this.version){}this.version++}static GetNoteLinkOpeningTag(e){return`<a id="${e}" href="#0">`}swapNotes(e,n,s){var r=R(e.children).map(function(o){return o==n.id?s.id:o==s.id?n.id:o});e.children.set(r)}}let ce=new he,Mt=0;const $t=function(){return Mt++},ie=de(null),be=de(null),oe=de([]),Ae={copiedInstances:[]},Lt={MIN_TEXTBOX_HEIGHT:50};function Xe(t,e,n){const s=t.slice();return s[2]=e[n],s[48]=e,s[49]=n,s}function je(t,e,n){const s=t.slice();return s[2]=e[n],s[50]=e,s[49]=n,s}function We(t,e,n){const s=t.slice();return s[2]=e[n],s[51]=e,s[49]=n,s}function Ut(t){let e,n=[],s=new Map,r,o,l,a=t[5];const p=i=>i[2];for(let i=0;i<a.length;i+=1){let c=We(t,a,i),h=p(c);s.set(h,n[i]=Je(h,c))}return{c(){e=E("div");for(let i=0;i<n.length;i+=1)n[i].c();b(e,"id","notepad"),b(e,"class","svelte-9z2dqz"),z(e,"isFocused",t[11])},m(i,c){M(i,e,c);for(let h=0;h<n.length;h+=1)n[h]&&n[h].m(e,null);r=!0,o||(l=j(e,"click",nt(t[32])),o=!0)},p(i,c){c[0]&786722&&(a=i[5],ae(),n=Me(n,c,p,1,i,a,s,e,Oe,Je,null,We),fe()),(!r||c[0]&2048)&&z(e,"isFocused",i[11])},i(i){if(!r){for(let c=0;c<a.length;c+=1)N(n[c]);r=!0}},o(i){for(let c=0;c<n.length;c+=1)O(n[c]);r=!1},d(i){i&&A(e);for(let c=0;c<n.length;c+=1)n[c].d();o=!1,l()}}}function Je(t,e){let n,s,r=e[49],o;const l=()=>e[30](s,r),a=()=>e[30](null,r);let p={noteId:e[2]};return s=new Ee({props:p}),l(),s.$on("SwapChildren",e[18]),s.$on("DeleteChild",e[19]),s.$on("Focus",e[31]),{key:t,first:null,c(){n=we(),se(s.$$.fragment),this.first=n},m(i,c){M(i,n,c),Q(s,i,c),o=!0},p(i,c){e=i,r!==e[49]&&(a(),r=e[49],l());const h={};c[0]&32&&(h.noteId=e[2]),s.$set(h)},i(i){o||(N(s.$$.fragment,i),o=!0)},o(i){O(s.$$.fragment,i),o=!1},d(i){i&&A(n),a(),Y(s,i)}}}function zt(t){let e,n,s=t[3]?"v":">",r,o,l,a,p,i,c,h;function f(m,v){return m[12]?Kt:Ht}let d=f(t),_=d(t),g=t[4]&&Ve(t);return{c(){e=E("div"),n=E("button"),r=ne(s),o=K(),l=E("span"),_.c(),a=K(),g&&g.c(),p=we(),b(n,"id","toggleButton"),b(n,"class","svelte-9z2dqz"),z(n,"boldText",t[5].length>0),b(l,"id","text"),b(l,"class","svelte-9z2dqz"),b(e,"id","topRow"),b(e,"class","svelte-9z2dqz")},m(m,v){M(m,e,v),w(e,n),w(n,r),w(e,o),w(e,l),_.m(l,null),M(m,a,v),g&&g.m(m,v),M(m,p,v),i=!0,c||(h=[j(n,"click",t[33]),j(l,"click",nt(t[36]))],c=!0)},p(m,v){(!i||v[0]&8)&&s!==(s=m[3]?"v":">")&&st(r,s),(!i||v[0]&32)&&z(n,"boldText",m[5].length>0),d===(d=f(m))&&_?_.p(m,v):(_.d(1),_=d(m),_&&(_.c(),_.m(l,null))),m[4]?g?(g.p(m,v),v[0]&16&&N(g,1)):(g=Ve(m),g.c(),N(g,1),g.m(p.parentNode,p)):g&&(ae(),O(g,1,1,()=>{g=null}),fe())},i(m){i||(N(g),i=!0)},o(m){O(g),i=!1},d(m){m&&A(e),_.d(),m&&A(a),g&&g.d(m),m&&A(p),c=!1,G(h)}}}function Ht(t){let e;return{c(){e=E("span")},m(n,s){M(n,e,s),e.innerHTML=t[6]},p(n,s){s[0]&64&&(e.innerHTML=n[6])},d(n){n&&A(e)}}}function Kt(t){let e,n,s;return{c(){e=E("textarea"),b(e,"class","svelte-9z2dqz")},m(r,o){M(r,e,o),t[34](e),Pe(e,t[6]),n||(s=[j(e,"input",t[35]),j(e,"input",t[20])],n=!0)},p(r,o){o[0]&64&&Pe(e,r[6])},d(r){r&&A(e),t[34](null),n=!1,G(s)}}}function Ve(t){let e,n=[],s=new Map,r,o=[],l=new Map,a,p=t[5];const i=f=>f[2];for(let f=0;f<p.length;f+=1){let d=je(t,p,f),_=i(d);s.set(_,n[f]=Qe(_,d))}let c=t[10];const h=f=>f[2];for(let f=0;f<c.length;f+=1){let d=Xe(t,c,f),_=h(d);l.set(_,o[f]=Ye(_,d))}return{c(){e=E("div");for(let f=0;f<n.length;f+=1)n[f].c();r=K();for(let f=0;f<o.length;f+=1)o[f].c();b(e,"id","childContainer"),b(e,"class","svelte-9z2dqz"),z(e,"hidden",!t[3])},m(f,d){M(f,e,d);for(let _=0;_<n.length;_+=1)n[_]&&n[_].m(e,null);w(e,r);for(let _=0;_<o.length;_+=1)o[_]&&o[_].m(e,null);a=!0},p(f,d){d[0]&786722&&(p=f[5],ae(),n=Me(n,d,i,1,f,p,s,e,Oe,Qe,r,je),fe()),d[0]&525826&&(c=f[10],ae(),o=Me(o,d,h,1,f,c,l,e,Oe,Ye,null,Xe),fe()),(!a||d[0]&8)&&z(e,"hidden",!f[3])},i(f){if(!a){for(let d=0;d<p.length;d+=1)N(n[d]);for(let d=0;d<c.length;d+=1)N(o[d]);a=!0}},o(f){for(let d=0;d<n.length;d+=1)O(n[d]);for(let d=0;d<o.length;d+=1)O(o[d]);a=!1},d(f){f&&A(e);for(let d=0;d<n.length;d+=1)n[d].d();for(let d=0;d<o.length;d+=1)o[d].d()}}}function Qe(t,e){let n,s,r=e[49],o;const l=()=>e[37](s,r),a=()=>e[37](null,r);let p={noteId:e[2]};return s=new Ee({props:p}),l(),s.$on("SwapChildren",e[18]),s.$on("DeleteChild",e[19]),s.$on("Focus",e[38]),{key:t,first:null,c(){n=we(),se(s.$$.fragment),this.first=n},m(i,c){M(i,n,c),Q(s,i,c),o=!0},p(i,c){e=i,r!==e[49]&&(a(),r=e[49],l());const h={};c[0]&32&&(h.noteId=e[2]),s.$set(h)},i(i){o||(N(s.$$.fragment,i),o=!0)},o(i){O(s.$$.fragment,i),o=!1},d(i){i&&A(n),a(),Y(s,i)}}}function Ye(t,e){let n,s,r=e[49],o;const l=()=>e[39](s,r),a=()=>e[39](null,r);let p={noteId:e[2],isReference:!0};return s=new Ee({props:p}),l(),s.$on("DeleteChild",e[19]),s.$on("Focus",e[40]),{key:t,first:null,c(){n=we(),se(s.$$.fragment),this.first=n},m(i,c){M(i,n,c),Q(s,i,c),o=!0},p(i,c){e=i,r!==e[49]&&(a(),r=e[49],l());const h={};c[0]&1024&&(h.noteId=e[2]),s.$set(h)},i(i){o||(N(s.$$.fragment,i),o=!0)},o(i){O(s.$$.fragment,i),o=!1},d(i){i&&A(n),a(),Y(s,i)}}}function Rt(t){let e,n,s,r=t[15]&&Ut(t),o=!t[15]&&zt(t);return{c(){e=E("div"),r&&r.c(),n=K(),o&&o.c(),b(e,"id","note "+t[14].id),b(e,"class","noteWrapper svelte-9z2dqz"),b(e,"style",t[15]?"height: 100%;":""),z(e,"selected",t[13]),z(e,"isFocused",t[11]),z(e,"referenceContainer",t[0])},m(l,a){M(l,e,a),r&&r.m(e,null),w(e,n),o&&o.m(e,null),s=!0},p(l,a){l[15]&&r.p(l,a),l[15]||o.p(l,a),(!s||a[0]&8192)&&z(e,"selected",l[13]),(!s||a[0]&2048)&&z(e,"isFocused",l[11]),(!s||a[0]&1)&&z(e,"referenceContainer",l[0])},i(l){s||(N(r),N(o),s=!0)},o(l){O(r),O(o),s=!1},d(l){l&&A(e),r&&r.d(),o&&o.d()}}}function Bt(t){return t.endsWith("*")?t.slice(0,-1):t}function Pt(t,e,n){let s,r,o,l,a,p,i,c;re(t,oe,u=>n(27,p=u)),re(t,be,u=>n(28,i=u)),re(t,ie,u=>n(29,c=u));const h=At(),f=function(){h("DeleteChild",{target:F,isFocused:_e})},d=$t();let{noteId:_}=e,{isReference:g=!1}=e,v=ce.notes[_];const F={note:v,noteId:_,instanceId:d,Delete:f};let C,P=[],X=[],W=[];const k=_==0;let U=v.markup;re(t,U,u=>n(6,a=u));let $=v.children;re(t,$,u=>n(5,l=u));let L=!1;const lt=function(){n(3,L=!0)},Ue=async function(u){if(!(u<=0)){await De();var y=[...P,...X];y.forEach(T=>{T.Expand(),T.ExpandAll(u-1)})}};let _e=!1,{Focus:q=function(u=!1){if(c!=F&&be.set(null),ie.set(F),k){u||oe.set([]);return}else Ie(F,u)}}=e;F.Focus=q;let Ie=function(u,y){let T=y?[...p,u]:[u];oe.set(T)},ct=function(u){let{child_to_swap:y,moveUp:T}=u.detail;var D=l.indexOf(y),I=D+(T?-1:1),S=I>=0&&I<l.length;if(S){let B=[...l];[B[D],B[I]]=[B[I],B[D]],$.set(B)}},ut=function(u){let{target:y,isFocused:T}=u.detail;if(T){var D=ge();let S=D.indexOf(y);if(S==1)q();else{var I=D[S-1];ie.set(I),oe.set([I])}}n(10,W=W.filter(S=>S!=y.instanceId)),$.set([...l.filter(S=>S!=y.note.id)])};const ge=function(){var u=[F];if(L||k){var y=[...P,...X];y.forEach(T=>{if(T!=null){var D=[];D=T.getSortedGenespan(),u=u.concat(D)}})}return u};let ze=function(u){if(_e){if(u.stopImmediatePropagation(),!s)switch(u.key){case"ArrowUp":u.shiftKey&&h("SwapChildren",{child_to_swap:v.id,moveUp:!0});break;case"ArrowDown":u.shiftKey&&h("SwapChildren",{child_to_swap:v.id,moveUp:!1});break;case"ArrowLeft":h("Focus",{keepSelection:u.ctrlKey});break;case"Insert":u.preventDefault();var y=ce.addNewChild({parent:v});n(3,L=!0),u.ctrlKey||De().then(()=>{ge().forEach(S=>{S.note==y&&(ie.set(S),oe.set([S]))})});break;case"Tab":u.preventDefault(),n(3,L=!L),u.shiftKey&&Ue(2);break;case"Enter":k||(u.preventDefault(),be.set(F),De().then(()=>{C.focus(),Ie(F,!1),He()}));break;case"i":if(u.ctrlKey)debugger;break;case"c":u.ctrlKey&&(Ae.copiedInstances=[...p]);break;case"x":u.ctrlKey&&(Ae.copiedInstances=[...p]);break;case"v":u.ctrlKey&&(Ae.copiedInstances.forEach(function(I){var S=l.includes(I.noteId);S||(v.add(I.note),I.Delete())}),l.length>0&&n(3,L=!0));break;case"Alt":u.preventDefault();break}if(s)switch(u.key){case"Enter":break;case"Alt":u.preventDefault(),be.set(null);break;case"Tab":u.preventDefault();var T=C.selectionStart,D=C.selectionEnd;n(7,C.value=C.value.substring(0,T)+"	"+C.value.substring(D),C),n(7,C.selectionStart=n(7,C.selectionEnd=T+1,C),C)}}};Ne(()=>{window.addEventListener("keydown",ze)}),St(()=>{window.removeEventListener("keydown",ze)});function He(){var u=Math.max(Lt.MIN_TEXTBOX_HEIGHT,C.scrollHeight)+"px";n(7,C.style.height=u,C)}k&&(Ne(q),window.addEventListener("keydown",function(y){let T=function(D){for(var I=ge(),S,B=0;B<I.length;B++){var yt=I[B];if(yt==c){S=B;break}}var Ce=S+(D?-1:1),kt=Ce>=0&&Ce<I.length;return kt?I[Ce]:null};if((y.key=="ArrowUp"||y.key=="ArrowDown")&&i==null&&(y.preventDefault(),!y.shiftKey)){let D=y.key=="ArrowUp",I=T(D);I!=null&&(ie.set(I),Ie(I,y.ctrlKey))}y.key=="Delete"&&p.forEach(D=>{D.Delete()})}));var Ke=function(){document.title.endsWith("*")||(document.title=document.title+"*")};k&&Ne(()=>{document.title=Bt(document.title)});function Re(){h("CloseHelp")}function at(u,y){J[u?"unshift":"push"](()=>{P[y]=u,n(8,P)})}const ft=u=>{q(u.detail.keepSelection)},dt=u=>{q(u.ctrlKey),Re()},ht=()=>{n(3,L=!L)};function pt(u){J[u?"unshift":"push"](()=>{C=u,n(7,C)})}function _t(){a=this.value,U.set(a)}const gt=u=>{q(u.ctrlKey)};function mt(u,y){J[u?"unshift":"push"](()=>{P[y]=u,n(8,P)})}const bt=u=>{q(u.detail.keepSelection)};function vt(u,y){J[u?"unshift":"push"](()=>{X[y]=u,n(9,X)})}const wt=u=>{q(u.detail.keepSelection)};return t.$$set=u=>{"noteId"in u&&n(2,_=u.noteId),"isReference"in u&&n(0,g=u.isReference),"Focus"in u&&n(1,q=u.Focus)},t.$$.update=()=>{t.$$.dirty[0]&335544320&&n(12,s=i==F),t.$$.dirty[0]&24&&n(4,r=L||r),t.$$.dirty[0]&603979776&&n(11,_e=c===F),t.$$.dirty[0]&201326592&&n(13,o=p.includes(F)),t.$$.dirty[0]&64&&Ke(),t.$$.dirty[0]&32&&Ke()},[g,q,_,L,r,l,a,C,P,X,W,_e,s,o,v,k,U,$,ct,ut,He,Re,d,lt,Ue,ge,F,p,i,c,at,ft,dt,ht,pt,_t,gt,mt,bt,vt,wt]}class Ee extends ke{constructor(e){super(),ye(this,e,Pt,Rt,pe,{instanceId:22,noteId:2,isReference:0,Expand:23,ExpandAll:24,Focus:1,getSortedGenespan:25},null,[-1,-1])}get instanceId(){return this.$$.ctx[22]}get Expand(){return this.$$.ctx[23]}get ExpandAll(){return this.$$.ctx[24]}get getSortedGenespan(){return this.$$.ctx[25]}}function qt(t){let e,n,s,r,o,l,a,p;return{c(){e=E("div"),n=E("button"),n.textContent="Download",s=K(),r=E("label"),r.textContent="Upload",o=K(),l=E("input"),b(n,"id","download_btn"),b(n,"class","file-button svelte-e1fw06"),b(r,"id","upload_btn"),b(r,"class","file-button svelte-e1fw06"),b(r,"for","file"),b(l,"id","file"),b(l,"type","file"),b(l,"accept",".tnp"),Nt(l,"display","none"),b(e,"id","MenuBar"),b(e,"class","svelte-e1fw06")},m(i,c){M(i,e,c),w(e,n),w(e,s),w(e,r),w(e,o),w(e,l),t[3](l),a||(p=[j(n,"click",function(){$e(t[0])&&t[0].apply(this,arguments)}),j(l,"change",t[2])],a=!0)},p(i,[c]){t=i},i:H,o:H,d(i){i&&A(e),t[3](null),a=!1,G(p)}}}function Gt(t){return t.slice(0,-4)}function Ze(){document.title=Xt(document.title)}function Xt(t){return t.endsWith("*")?t.slice(0,-1):t}function jt(t,e,n){let s,r=async function(i){var c=R(ce.notes[0].children).length==0,h=s.files.length>0;if(h&&c){var f=Gt(s.files[0].name);document.title=f}for(var d=0;d<s.files.length;d++){var _=s.files[d];await o(_)}n(1,s.value="",s),setTimeout(Ze,100)},o=async function(i){var c=await i.text(),h=new he;h.loadFromJSON(JSON.parse(c)),h.Update();var f=h.notes[0];f.markup.set(i.name),ce.Merge(h)},{download:l=function(){var i=ce.getCopyForDownload(),c=JSON.stringify(i),h=new Blob([c],{type:"application/octet-binary"});a(h),Ze()}}=e,a=function(i){var c=document.createElement("a");c.setAttribute("href",URL.createObjectURL(i)),c.setAttribute("download",document.title+".tnp"),c.click()};function p(i){J[i?"unshift":"push"](()=>{s=i,n(1,s)})}return t.$$set=i=>{"download"in i&&n(0,l=i.download)},[l,s,r,p]}class Wt extends ke{constructor(e){super(),ye(this,e,jt,qt,pe,{download:0})}}function Jt(t,e,n){const s=t.slice();return s[0]=e[n][0],s[1]=e[n][1],s}function Vt(t){let e,n,s,r,o,l,a;return{c(){e=E("tr"),n=E("td"),s=ne(t[0]),r=K(),o=E("td"),l=ne(t[1]),a=K(),b(n,"class","svelte-108dde0"),b(o,"class","svelte-108dde0")},m(p,i){M(p,e,i),w(e,n),w(n,s),w(e,r),w(e,o),w(o,l),w(e,a)},p:H,d(p){p&&A(e)}}}function Qt(t){let e,n,s,r,o,l,a,p=[["Insert","Add a new note under the focused one"],["Delete","Delete selected notes"],["Up/Down Arrow","Move focus up/down"],["Enter","Make a note editable"],["Alt","Return an editable note to being uneditable"],["Shift+Up/Down","Swap Adjacent Siblings"],["Click on note","Focuses note"],["Ctrl+Focus Note","Keeps notes selected while focusing new one"],["Ctrl+C/X/V","Copy/Cut/Paste selected notes"],["Tab","Toggles whether focused note is expanded"],["Tab+Shift","Also expands children and grandchildren"]],i=[];for(let c=0;c<11;c+=1)i[c]=Vt(Jt(t,p,c));return{c(){e=E("div"),n=E("div"),n.innerHTML="<h2>Controls</h2>",s=K(),r=E("table"),o=E("thead"),o.innerHTML=`<tr><th class="svelte-108dde0">Command</th> 
            <th class="svelte-108dde0">Description</th></tr>`,l=K(),a=E("tbody");for(let c=0;c<11;c+=1)i[c].c();b(n,"class","title svelte-108dde0"),b(r,"class","svelte-108dde0"),b(e,"class","menu svelte-108dde0")},m(c,h){M(c,e,h),w(e,n),w(e,s),w(e,r),w(r,o),w(r,l),w(r,a);for(let f=0;f<11;f+=1)i[f]&&i[f].m(a,null)},p:H,i:H,o:H,d(c){c&&A(e),It(i,c)}}}class Yt extends ke{constructor(e){super(),ye(this,e,null,Qt,pe,{})}}function xe(t){let e,n,s;return n=new Yt({}),{c(){e=E("div"),se(n.$$.fragment),b(e,"id","helpWrapper"),b(e,"class","svelte-wm15kg")},m(r,o){M(r,e,o),Q(n,e,null),s=!0},i(r){s||(N(n.$$.fragment,r),s=!0)},o(r){O(n.$$.fragment,r),s=!1},d(r){r&&A(e),Y(n)}}}function Zt(t){let e,n,s,r,o,l,a=t[0]?"X":"?",p,i,c,h,f,d,_;r=new Wt({});let g=t[0]&&xe();return h=new Ee({props:{noteId:0}}),h.$on("CloseHelp",t[1]),{c(){e=E("main"),n=E("div"),s=E("span"),se(r.$$.fragment),o=K(),l=E("button"),p=ne(a),i=K(),g&&g.c(),c=K(),se(h.$$.fragment),b(s,"id","Menubar"),b(s,"class","svelte-wm15kg"),b(l,"class","svelte-wm15kg"),z(l,"close-btn",t[0]),b(n,"id","Topbar"),b(n,"class","svelte-wm15kg"),b(e,"data-testid","my-element"),b(e,"class","svelte-wm15kg")},m(m,v){M(m,e,v),w(e,n),w(n,s),Q(r,s,null),w(n,o),w(n,l),w(l,p),w(e,i),g&&g.m(e,null),w(e,c),Q(h,e,null),f=!0,d||(_=j(l,"click",t[2]),d=!0)},p(m,[v]){(!f||v&1)&&a!==(a=m[0]?"X":"?")&&st(p,a),(!f||v&1)&&z(l,"close-btn",m[0]),m[0]?g?v&1&&N(g,1):(g=xe(),g.c(),N(g,1),g.m(e,c)):g&&(ae(),O(g,1,1,()=>{g=null}),fe())},i(m){f||(N(r.$$.fragment,m),N(g),N(h.$$.fragment,m),f=!0)},o(m){O(r.$$.fragment,m),O(g),O(h.$$.fragment,m),f=!1},d(m){m&&A(e),Y(r),g&&g.d(),Y(h),d=!1,_()}}}function xt(t,e,n){let s=!1;return[s,function(){n(0,s=!1)},()=>n(0,s=!s)]}class en extends ke{constructor(e){super(),ye(this,e,xt,Zt,pe,{})}}new en({target:document.getElementById("app")});
